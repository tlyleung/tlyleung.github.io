---
layout: post
title: Deriving Blackjack’s Basic Strategy using Reinforcement Learning
description: Tabular solution methods from reinforcement learning are used to derive Blackjack’s basic strategy.
authors: [tlyleung]
x: 33
y: 46
---

## Background

Blackjack, often referred to as 21, is one of the most popular casino games worldwide. Its roots can be traced back to the 17th century, with a similar game called "Vingt-et-Un" played in French casinos. However, the modern game as we know it, along with the quest to crack its code of strategy, began in the United States in the early 20th century.

The objective of Blackjack is deceptively simple: beat the dealer's hand without exceeding 21. For years, it was a game of intuition and luck, until the 1950s, when the first scientific approach to the game emerged. Roger Baldwin, Wilbert Cantey, Herbert Maisel, and James McDermott, known as the "Four Horsemen of Aberdeen," used calculators and probability theory to analyze the game. Their 1956 publication[^baldwin56] in the Journal of the American Statistical Association laid the groundwork for all future efforts in understanding Blackjack strategy, presenting a *basic strategy* to minimize the house edge.

### Simulation Meets Strategy

The advent of computers brought a revolutionary turn to the Blackjack table. In 1962, Edward Thorp capitalized on the computing power of the IBM 704 to refine the basic strategy calculations. His book, "Beat the Dealer,"[^thorp66] was the first to include a mathematically proven, computer-analyzed basic strategy for Blackjack. Thorp's work used computer simulations to test and perfect the basic strategy, demonstrating that the house edge could not only be minimized but, under certain circumstances, players could actually gain an advantage. The concept of card counting, allowing players to adjust their bets based on the composition of cards remaining in the deck, received wider recognition following its inclusion in the book. The casino industry was rocked by these revelations, prompting changes in game rules and the start of a cat-and-mouse game between casinos and players. Various Blackjack teams employing these techniques started springing up across the world, including the MIT Blackjack Team popularised by the movie 21.

### Continually Refining the Basic Strategy

Since Thorp's revelations, the basic strategy for Blackjack has been continuously refined. The introduction of high-speed computers and sophisticated simulation software in the 1990s (such as CVDATA[^qfit23] which is still used today) made it possible to simulate billions of hands of Blackjack. This allowed researchers and analysts to fine-tune the basic strategy for different rule sets and number of decks in play. As a result, basic strategy charts became more precise and customized to specific game conditions. Today, basic strategy is recognized as the optimal way to play each hand in Blackjack. It is no longer just about the decision to hit or stand; it incorporates a variety of player decisions including doubling down, splitting pairs, and even the timing of surrender. 

### Tabular Solution Methods

In this post, we'll use a number of reinforcement learning techniques to derive the basic strategy. For a game like Blackjack, which has a relatively small and discrete state space that can fit in computer memory, simpler tabular solution methods are suitable. Each of these methods has its own advantages and can be suitable for different scenarios:

- **Policy Iteration:** This iterative dynamic programming algorithm alternates between evaluating the current policy and improving it by making it greedier. In the context of Blackjack, this method can systematically calculate the expected returns for each possible action, refining the strategy until it cannot be further improved. It requires a full model of the environment, which may not always be available.

- **Monte Carlo with Exploring Starts:** This technique simulates many Blackjack games, starting from random states and actions, to estimate the value of each decision. It converges to the best strategy by learning from the outcomes of each game, without needing a pre-defined model of the game's dynamics.

- **Q-Learning:** Methods like SARSA and Q-learning are part of the Temporal Difference (TD) learning family. They update the value functions based on the estimated returns rather than waiting until the end of the episode, as in Monte Carlo methods. These methods can learn optimal policies online without the need for episode completion and don't require a full environmental model.

## Dynamic Programming: Policy Iteration

Dynamic programming is a method used to solve complex problems by breaking them down into simpler subproblems. It is based on the principle of optimality, which states that the optimal solution to a problem can be composed of optimal solutions to its subproblems. In the context of reinforcement learning, dynamic programming techniques are used to solve Markov Decision Processes (MDPs) where the full model of the environment is known, including state transition probabilities and rewards.

Policy iteration is a dynamic programming algorithm used to find the optimal policy in an MDP. It alternates between two steps: policy evaluation and policy improvement. During policy evaluation, the value function for a given policy is calculated until it sufficiently converges (i.e., changes between iterations are below a small threshold $$\Delta$$). Policy improvement then updates the policy by making it greedier with respect to the current value function; that is, for each state, the action that yields the highest value according to the current value function is chosen. This process repeats until the policy is stable, meaning it no longer changes from one iteration to the next, indicating that the optimal policy has been found.

> **Policy Iteration (using iterative policy evaluation) for estimating $$\pi \approx \pi_*$$**
> 
> 1. Initialization<br>
>    $$V(s) \in R$$ and $$\pi(s) \in A(s)$$ arbitrarily for all $$s \in S$$; $$V(terminal) = 0$$
>
> 2. Policy Evaluation<br>
>    Loop:<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;$$\Delta \leftarrow 0$$<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;Loop for each $$s \in \mathcal{S}$$:<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$v \leftarrow V(s)$$<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$V(s) \leftarrow \sum_{s', r} p(s', r|s, \pi(s))[r + \gamma V(s')]$$<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$\Delta \leftarrow \max(\Delta, |v - V(s)|)$$<br>
>    until $$\Delta < \theta$$ (a small positive number determining the accuracy of estimation)
>
> 3. Policy Improvement<br>
>    $$\textit{policy-stable} \leftarrow true$$<br>
>    For each $$s \in \mathcal{S}$$:<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;$$\textit{old-action} \leftarrow \pi(s)$$<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;$$\pi(s) \leftarrow \textrm{argmax}_a \sum_{s', r} p(s', r|s, a)[r + \gamma V(s')]$$<br>
>    &nbsp;&nbsp;&nbsp;&nbsp;If $$\textit{old-action} \neq \pi(s)$$, then $$\textit{policy-stable} \leftarrow false$$<br>
>    If $$\textit{policy-stable}$$, then stop and return $$V \approx v_*$$ and $$\pi \approx \pi_*$$; else go to 2
>
> *Source: Sutton & Barto, 2020, p. 80*

First, we start off with loading some functions from Gymnasium's Blackjack environment implementation[^towers23], that will help us with policy iteration, even though in this section we don't use the environment itself.


```python
def cmp(a, b):
    return float(a > b) - float(a < b)


def draw_card(np_random):
    return int(np_random.choice(deck))


def draw_hand(np_random):
    return [draw_card(np_random), draw_card(np_random)]


def has_usable_ace(hand):  # does this hand have a usable ace?
    return int(1 in hand and sum(hand) + 10 <= 21)


def sum_hand(hand):  # return current hand total
    return sum(hand) + (10 if has_usable_ace(hand) else 0)


def is_bust(hand):  # is this hand a bust?
    return sum_hand(hand) > 21


def score(hand):  # what is the score of this hand (0 if bust)
    return 0 if is_bust(hand) else sum_hand(hand)


def is_natural(hand):  # Is this hand a natural blackjack?
    return sorted(hand) == [1, 10]
```

Then, through simulation, we precompute the distribution of possible outcomes for each of the dealer's potential starting cards. This is used when the player stands or doubles and the dealer plays out their hand.


```python
import numpy as np


probabilities = np.zeros((11, 22))
num_simulations = 1_000_000
deck = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]

for _ in range(num_simulations):
    dealer_card_value = int(np.random.choice(deck))
    dealer_cards = [dealer_card_value, int(np.random.choice(deck))]
    while sum_hand(dealer_cards) < 17:
        dealer_cards.append(int(np.random.choice(deck)))
        
    probabilities[dealer_card_value][score(dealer_cards)] += 1
    
probabilities /= probabilities.sum(axis=1, keepdims=True)
```

We're using the simplified version of Blackjack described in Example 5.1 of Reinforcement Learning: An Introduction[^sutton20] and the Easy21 assignment[^silver15]. This version of Blackjack follows the typical rules, where the objective is to obtain cards whose sum is as close to 21 as possible without going over, but we are limited to only two actions: stand and hit. The `expected_return` function lays out the complete state transition probabilities and rewards.


```python
def expected_return(state, action, V, gamma=1.0):
    player_sum, dealer_card_value, usable_ace = state
    rewards = 0.0

    # 1 = Ace, 2-10 = Number cards, Jack/Queen/King = 10
    deck = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]

    # Get probabilities for each card in the deck
    card_probabilities = {card: deck.count(card) / len(deck) for card in set(deck)}

    if action == 0:  # stand
        dealer_scores = probabilities[dealer_card_value]
        wins = np.sum(dealer_scores[0:player_sum])
        losses = np.sum(dealer_scores[(player_sum + 1) :])
        rewards = wins - losses
    else:  # hit
        for next_card in set(deck):
            player_cards = [1, player_sum - 11] if usable_ace else [player_sum]
            player_cards.append(next_card)
            next_player_sum = sum_hand(player_cards)
            next_usable_ace = has_usable_ace(player_cards)

            if is_bust(player_cards):
                reward = -1
            else:
                next_state = (next_player_sum, dealer_card_value, next_usable_ace)
                reward = gamma * V[next_state]  # no immediate reward for hitting

            rewards += card_probabilities[next_card] * reward

    return rewards
```


```python
def policy_evaluation(V, policy, theta=1e-10):
    while True:
        delta = 0.0
        for state in np.ndindex(V.shape):
            v = V[state]
            action = policy[state]
            V[state] = expected_return(state, action, V)
            delta = max(delta, abs(v - V[state]))
        if delta < theta:
            break


def policy_improvement(V, policy):
    policy_stable = True
    for state in np.ndindex(V.shape):
        old_action = policy[state]
        action_values = {action: expected_return(state, action, V) for action in [0, 1]}
        policy[state] = max(action_values, key=action_values.get)
        if old_action != policy[state]:
            policy_stable = False
    return policy_stable


def policy_iteration(V, policy):
    policy_stable = False
    while not policy_stable:
        policy_evaluation(V, policy)
        policy_stable = policy_improvement(V, policy)
```


```python
# Initialize state-value function V and policy
V = np.zeros((32, 11, 2))
policy = np.zeros((32, 11, 2), dtype=int)

policy_iteration(V, policy)

# Build state-action-value function Q
Q1 = np.zeros((32, 11, 2, 2))

for index in np.ndindex(Q1.shape):
    *state, action = index
    Q1[index] = expected_return(state, action, V)
```

Plotting the policy $$\pi$$ and the state-action value function $$Q$$, we get:

#### Optimal Policy using Policy Iteration

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-6"><div>                            <div id="f7d55c5e-a149-49ef-942a-2a5a725c50dd" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("f7d55c5e-a149-49ef-942a-2a5a725c50dd")) {                    Plotly.newPlot(                        "f7d55c5e-a149-49ef-942a-2a5a725c50dd",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,0,0,0,0,0,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eSoft player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Soft player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":5.5,"y":14.5}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-6"><div>                            <div id="763a0470-dbaa-4d0d-b022-90c20c552bd6" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("763a0470-dbaa-4d0d-b022-90c20c552bd6")) {                    Plotly.newPlot(                        "763a0470-dbaa-4d0d-b022-90c20c552bd6",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eHard player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Hard player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":8.5,"y":14.0}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

## Gymnasium Environment

Dynamic programming methods depend on having a complete model of the environment, including all possible state transitions and rewards, which isn't always available. The next two tabular solution methods only require an interactive environment. The Blackjack environment from Gymnasium follows the same simplified version of the Blackjack card game in the previous section. 

Here's a short tutorial on how to use the Blackjack Gymnasium environment:

### Initialization

To start using the Blackjack environment, you need to import the Gymnasium package and then create and initialize the Blackjack environment:


```python
import gymnasium as gym

# Create the Blackjack environment
env = gym.make('Blackjack-v1')

# Start a new game
state, info = env.reset()

print(state)
```

    (12, 10, 0)


The `reset` method starts a new game and returns the initial game state, which typically includes the player's current sum, the dealer's one visible card, and whether or not the player has a usable ace (an ace that can be counted as 11 without busting).

### Game Dynamics

You interact with the game by calling the `step` method with an action:

- action = 0 corresponds to "stick" or "stand" (not asking for another card)
- action = 1 corresponds to "hit" (asking for another card to try to get closer to 21)

The step method returns:

- `next_state`: the new state after the action
- `reward`: the reward from the action
- `terminated`: a boolean indicating if the game is over
- `truncated`: a boolean indicating that the episode has ending due to an externally defined condition
- `info`: a dictionary with additional information, usually empty in the Blackjack environment


```python
# Example action: hit
next_state, reward, terminated, truncated, info = env.step(1)

print(next_state)
```

    (19, 10, 0)


### Ending the Game

The game continues with the player taking actions until they decide to stand or they bust (their sum exceeds 21). Once the player stands, the dealer plays with a fixed strategy (such as hitting until the dealer's sum is 17 or more). After the dealer's turn, the game ends and the done flag is set to True. The reward is then assigned: +1 for winning, 0 for a draw, and -1 for losing.

### Example Loop

Here's an example of playing one round of Blackjack with a simple strategy: hit until reaching 18 or more, then stand.


```python
import gymnasium as gym

env = gym.make('Blackjack-v1')

state, info = env.reset()

while True:
    player_sum, dealer_card, usable_ace = state
    action = 0 if player_sum >= 18 else 1   # strategy: hit until our sum is 18 or more
    state, reward, terminated, truncated, info = env.step(action)
    if terminated or truncated:
        break

print(f"Final state: {state}")
print(f"Reward: {reward}")
```

    Final state: (22, 5, 0)
    Reward: -1.0


### Closing the Environment

When you're done with the environment, you should close it to free up resources:


```python
env.close()
```

## Monte Carlo: Monte Carlo with Exploring Starts

Monte Carlo methods in reinforcement learning are used to estimate the value functions of states or state-action pairs based on averaging the returns (total rewards) received from episodes. These episodes are sequences of states, actions, and rewards, from the start of an environment to a terminal state.

Monte Carlo with Exploring Starts is a specific approach within this family of methods. The key features are:

- **Exploring Starts:** To ensure that all state-action pairs are visited sufficiently, each episode begins with a randomly chosen state and action. This is crucial for the method to explore and learn the value of all possible decisions in environments where some states or actions are less likely to be visited under a certain policy.

- **No Model Needed:** Unlike dynamic programming, Monte Carlo methods don't require a complete model of the environment's dynamics. They can learn directly from experience obtained through interaction with the environment.

- **Episode-based Learning:** The value of states or state-action pairs is updated after each episode. This means that the method waits until the end of an episode to update the value estimates based on the total return received.

In Blackjack, for instance, Monte Carlo with Exploring Starts can be used to estimate the optimal policy by simulating many hands of the game, each starting with a random state (player's and dealer's cards) and an initial action, and then playing out the hand according to a given policy.

> **Monte Carlo ES (Exploring Starts), for estimating $$\pi \approx \pi_*$$**
>
> Initialize:<br>
> &nbsp;&nbsp;&nbsp;&nbsp;$$\pi(s) \in \mathcal{A}(s)$$ (arbitrarily), for all $$s \in \mathcal{S}$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;$$Q(s, a) \in \mathbb{R}$$ (arbitrarily), for all $$s \in \mathcal{S}, a \in \mathcal{A}(s)$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;$$\mathit{Returns}(s, a) \leftarrow$$ empty list, for all $$s \in \mathcal{S}, a \in \mathcal{A}(s)$$<br>
>
> Loop forever (for each episode):<br>
> &nbsp;&nbsp;&nbsp;&nbsp;Choose $$S_0 \in \mathcal{S}, A_0 \in \mathcal{A}\left(S_0\right)$$ randomly such that all pairs have probability $$> 0$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;Generate an episode from $$S_0, A_0,$$ following $$\pi$$: $$S_0, A_0, R_1, \ldots, S_{T-1}, A_{T-1}, R_T$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;$$G \leftarrow 0$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;Loop for each step of episode, $$t=T-1, T-2, \ldots, 0$$:<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$G \leftarrow \gamma G + R_{t+1}$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unless the pair $$S_t, A_t$$ appears in $$S_0, A_0, S_1, A_1 \ldots, S_{t-1}, A_{t-1}:$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Append $$G$$ to $$\mathit{Returns}\left(S_t, A_t\right)$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$Q\left(S_t, A_t\right) \leftarrow \mathrm{average}\left(Returns\left(S_t, A_t\right)\right)$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$\pi\left(S_t\right) \leftarrow \mathrm{argmax}_a Q\left(S_t, a\right)$$
>
> *Source: Sutton & Barto, 2020, p. 99*


```python
import gymnasium as gym

from collections import deque
from tqdm import tqdm


# Function to generate a single episode using the current policy
def generate_episode(env, policy):
    episode = []
    state, _ = env.reset()  # choose S_0 randomly
    done = False
    while not done:
        # Select an action: choose A_0 randomly, policy-based subsequently
        action = env.action_space.sample() if not episode else policy[state]
        next_state, reward, done, _, _ = env.step(action)
        episode.append((state, action, reward))
        state = next_state
    return episode


def monte_carlo_es(env, gamma=0.95, num_episodes=1_000_000, deque_size=None):
    deque_size = num_episodes if deque_size is None else deque_size
    env = gym.wrappers.RecordEpisodeStatistics(env, deque_size=deque_size)
    state_n = [space.n for space in env.observation_space]
    state_action_n = state_n + [env.action_space.n]
    
    Qs = deque(maxlen=deque_size)
    Q = np.zeros(state_action_n)
    state_action_returns = np.zeros(state_action_n)
    state_action_counts = np.zeros(state_action_n, dtype=int)
    policy = np.ones(state_n, dtype=int)
    
    for _ in tqdm(range(num_episodes)):
        episode = generate_episode(env, policy)
        G = 0.0  # initialize the discounted return
        visited = set()  # create a set to track visited state-action pairs

        # Loop over episode in reverse to calculate returns and update Q-values
        for state, action, reward in reversed(episode):
            G = gamma * G + reward  # update discounted return

            if (state, action) not in visited:
                visited.add((state, action))
                state_action_returns[state][action] += G
                state_action_counts[state][action] += 1
                policy[state] = np.argmax(
                    state_action_returns[state] / state_action_counts[state]
                )
                
        Q = state_action_returns / state_action_counts
        Qs.append(Q)

    env.close()
    
    return np.stack(Qs), env.return_queue, env.length_queue
```


```python
env = gym.make("Blackjack-v1")
Qs2, return_queue2, length_queue2 = monte_carlo_es(env)
Q2 = Qs2[-1]
```

#### Optimal Policy using Monte Carlo ES (1M Episodes)

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-6"><div>                            <div id="62b52129-e6ba-4f42-a13b-7f9e1908b9d0" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("62b52129-e6ba-4f42-a13b-7f9e1908b9d0")) {                    Plotly.newPlot(                        "62b52129-e6ba-4f42-a13b-7f9e1908b9d0",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,0,0,0,0,0,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eSoft player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Soft player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":5.5,"y":14.5}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-6"><div>                            <div id="ce340a5d-962f-46c6-ad6e-86435279834c" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ce340a5d-962f-46c6-ad6e-86435279834c")) {                    Plotly.newPlot(                        "ce340a5d-962f-46c6-ad6e-86435279834c",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eHard player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Hard player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":8.5,"y":14.0}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

## Temporal Difference (TD) Learning: Q-Learning

Temporal Difference (TD) Learning, and specifically Q-Learning, is another method in reinforcement learning used for estimating the optimal policy. The key aspects are:

- **Learning from Incomplete Episodes**: TD methods, unlike Monte Carlo, do not need to wait until the end of an episode to update their value estimates. They can learn online after every step taken in the environment. This is particularly useful in environments where episodes are long or infinite.

- **Q-Learning**: This is a specific type of TD learning focused on learning the optimal action-value function, denoted as Q. Q-Learning is an off-policy learner, meaning it can learn the value of the optimal policy independently of the agent's actions. It updates its Q-values using the Bellman equation as follows:

  $$ Q(s_t, a_t) \leftarrow Q(s_t, a_t) + \alpha \left[ r_{t+1} + \gamma \max_{a} Q(s_{t+1}, a) - Q(s_t, a_t) \right]$$

  Here, $$\alpha$$ is the learning rate, $$\gamma$$ is the discount factor, $$r_{t+1}$$ is the reward received after taking action $$a_t$$ in state $$s_t$$, and $$\max_{a} Q(s_{t+1}, a)$$ is the maximum estimated value of any action in the next state $$s_{t+1}$$.

- **Model-Free**: Like Monte Carlo, Q-Learning does not require a model of the environment and learns from the experience obtained through interaction.

Q-Learning is particularly effective in environments with discrete states and actions, where the goal is to learn an optimal policy that maximizes the expected return. It is robust in stochastic environments and can handle problems with a large state space.

> **Q-learning (off-policy TD control) for estimating $$\pi \approx \pi_*$$**
>
> Algorithm parameters: step size $$\alpha \in (0, 1]$$, small $$\epsilon > 0$$<br>
> Initialize $$Q(s,a)$$, for all $$s \in \mathcal{S}^+, a \in \mathcal{A}(s)$$, arbitrarily except that $$Q(terminal,\cdot) = 0$$<br>
>
> Loop for each episode:<br>
> &nbsp;&nbsp;&nbsp;&nbsp;Initialize $$S$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;Loop for each step of episode:<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Choose $$A$$ from $$S$$ using policy derived from $$Q$$ (e.g., $$\epsilon$$-greedy)<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Take action $$A$$, observe $$R,S'$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$Q(S,A) \leftarrow Q(S,A) + \alpha \left[ R + \gamma \max_a Q(S',a) - Q(S,A) \right]$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$$S \leftarrow S'$$<br>
> &nbsp;&nbsp;&nbsp;&nbsp;until $$S$$ is terminal
>
> *Source: Sutton & Barto, 2020, p. 131*


```python
import gymnasium as gym

from collections import deque
from tqdm import tqdm


def q_learning(
    env,
    alpha=0.001,
    start_epsilon=1.0,
    end_epsilon=0.1,
    gamma=0.95,
    num_episodes=1_000_000,
    deque_size=None,
):
    deque_size = num_episodes if deque_size is None else deque_size
    env = gym.wrappers.RecordEpisodeStatistics(env, deque_size=deque_size)
    state_n = [space.n for space in env.observation_space]
    state_action_n = state_n + [env.action_space.n]

    Qs = deque(maxlen=deque_size)
    Q = np.zeros(state_action_n)

    for i in tqdm(range(num_episodes)):
        state, _ = env.reset()
        done = False

        epsilon = start_epsilon + (i / num_episodes) * (end_epsilon - start_epsilon)
        while not done:
            # Choose the next action using an epsilon-greedy policy
            if np.random.rand() < epsilon:
                action = env.action_space.sample()  # Explore: random action
            else:
                action = np.argmax(Q[state])  # Exploit: best action based on Q-values

            # Take action and observe reward and next state
            next_state, reward, done, _, _ = env.step(action)

            # Q-Learning update
            future_q = 0 if done else np.max(Q[next_state])
            temporal_difference = reward + gamma * future_q - Q[state][action]
            Q[state][action] += alpha * temporal_difference

            # Update state
            state = next_state

        Qs.append(Q.copy())

    env.close()

    return np.stack(Qs), env.return_queue, env.length_queue
```


```python
env = gym.make('Blackjack-v1')
Qs3, return_queue3, length_queue3 = q_learning(env)
Q3 = Qs3[-1]
```

### Optimal Policy using Q-Learning (1M Episodes)

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-6"><div>                            <div id="970ae1c2-3f36-4026-a00d-b0636d850224" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("970ae1c2-3f36-4026-a00d-b0636d850224")) {                    Plotly.newPlot(                        "970ae1c2-3f36-4026-a00d-b0636d850224",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,1,1],[0,1,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eSoft player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Soft player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":5.5,"y":14.5}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-6"><div>                            <div id="925c2863-ee6c-417e-91c4-524bdc4bd64e" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("925c2863-ee6c-417e-91c4-524bdc4bd64e")) {                    Plotly.newPlot(                        "925c2863-ee6c-417e-91c4-524bdc4bd64e",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eHard player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[10.5,21.5],"tickmode":"linear"},"coloraxis":{"colorscale":[[0,"#fafafa"],[1,"#d7d6cc"]],"showscale":false},"title":{"text":"Hard player sum vs. dealer showing","font":{"size":16},"x":0},"annotations":[{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"STAND","x":5.5,"y":19.5},{"font":{"color":"rgba(0, 0, 0, 0.1)","size":36},"showarrow":false,"text":"HIT","x":8.5,"y":14.0}],"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

Note: as can be seen in the two policy charts above, the policy is close to, but doesn't quite match the policies derived from the first method.

## Comparison

To aid the comparison between the two model-free approaches, in a method suggested by "Solving Blackjack with Q-Learning"[^zemann22], the environments were wrapped in a `RecordEpisodeStatistics` wrapper. This provides us with data on how episode returns and episode lengths change as training progresses. We also plot the MSE between the two model-free methods and the ground truth policy derived through policy iteration.

#### Training Statistics

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-6"><div>                            <div id="e50ffd9c-505d-41a2-99c5-4744c9fb555d" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e50ffd9c-505d-41a2-99c5-4744c9fb555d")) {                    Plotly.newPlot(                        "e50ffd9c-505d-41a2-99c5-4744c9fb555d",                        [{"hovertemplate":"Method: Monte Carlo ES\u003cbr\u003eEpisode: %{x}\u003cbr\u003eReturn: %{y}\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#d7d6cc"},"name":"Monte Carlo ES","x":[0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000,61000,62000,63000,64000,65000,66000,67000,68000,69000,70000,71000,72000,73000,74000,75000,76000,77000,78000,79000,80000,81000,82000,83000,84000,85000,86000,87000,88000,89000,90000,91000,92000,93000,94000,95000,96000,97000,98000,99000,100000,101000,102000,103000,104000,105000,106000,107000,108000,109000,110000,111000,112000,113000,114000,115000,116000,117000,118000,119000,120000,121000,122000,123000,124000,125000,126000,127000,128000,129000,130000,131000,132000,133000,134000,135000,136000,137000,138000,139000,140000,141000,142000,143000,144000,145000,146000,147000,148000,149000,150000,151000,152000,153000,154000,155000,156000,157000,158000,159000,160000,161000,162000,163000,164000,165000,166000,167000,168000,169000,170000,171000,172000,173000,174000,175000,176000,177000,178000,179000,180000,181000,182000,183000,184000,185000,186000,187000,188000,189000,190000,191000,192000,193000,194000,195000,196000,197000,198000,199000,200000,201000,202000,203000,204000,205000,206000,207000,208000,209000,210000,211000,212000,213000,214000,215000,216000,217000,218000,219000,220000,221000,222000,223000,224000,225000,226000,227000,228000,229000,230000,231000,232000,233000,234000,235000,236000,237000,238000,239000,240000,241000,242000,243000,244000,245000,246000,247000,248000,249000,250000,251000,252000,253000,254000,255000,256000,257000,258000,259000,260000,261000,262000,263000,264000,265000,266000,267000,268000,269000,270000,271000,272000,273000,274000,275000,276000,277000,278000,279000,280000,281000,282000,283000,284000,285000,286000,287000,288000,289000,290000,291000,292000,293000,294000,295000,296000,297000,298000,299000,300000,301000,302000,303000,304000,305000,306000,307000,308000,309000,310000,311000,312000,313000,314000,315000,316000,317000,318000,319000,320000,321000,322000,323000,324000,325000,326000,327000,328000,329000,330000,331000,332000,333000,334000,335000,336000,337000,338000,339000,340000,341000,342000,343000,344000,345000,346000,347000,348000,349000,350000,351000,352000,353000,354000,355000,356000,357000,358000,359000,360000,361000,362000,363000,364000,365000,366000,367000,368000,369000,370000,371000,372000,373000,374000,375000,376000,377000,378000,379000,380000,381000,382000,383000,384000,385000,386000,387000,388000,389000,390000,391000,392000,393000,394000,395000,396000,397000,398000,399000,400000,401000,402000,403000,404000,405000,406000,407000,408000,409000,410000,411000,412000,413000,414000,415000,416000,417000,418000,419000,420000,421000,422000,423000,424000,425000,426000,427000,428000,429000,430000,431000,432000,433000,434000,435000,436000,437000,438000,439000,440000,441000,442000,443000,444000,445000,446000,447000,448000,449000,450000,451000,452000,453000,454000,455000,456000,457000,458000,459000,460000,461000,462000,463000,464000,465000,466000,467000,468000,469000,470000,471000,472000,473000,474000,475000,476000,477000,478000,479000,480000,481000,482000,483000,484000,485000,486000,487000,488000,489000,490000,491000,492000,493000,494000,495000,496000,497000,498000,499000,500000,501000,502000,503000,504000,505000,506000,507000,508000,509000,510000,511000,512000,513000,514000,515000,516000,517000,518000,519000,520000,521000,522000,523000,524000,525000,526000,527000,528000,529000,530000,531000,532000,533000,534000,535000,536000,537000,538000,539000,540000,541000,542000,543000,544000,545000,546000,547000,548000,549000,550000,551000,552000,553000,554000,555000,556000,557000,558000,559000,560000,561000,562000,563000,564000,565000,566000,567000,568000,569000,570000,571000,572000,573000,574000,575000,576000,577000,578000,579000,580000,581000,582000,583000,584000,585000,586000,587000,588000,589000,590000,591000,592000,593000,594000,595000,596000,597000,598000,599000,600000,601000,602000,603000,604000,605000,606000,607000,608000,609000,610000,611000,612000,613000,614000,615000,616000,617000,618000,619000,620000,621000,622000,623000,624000,625000,626000,627000,628000,629000,630000,631000,632000,633000,634000,635000,636000,637000,638000,639000,640000,641000,642000,643000,644000,645000,646000,647000,648000,649000,650000,651000,652000,653000,654000,655000,656000,657000,658000,659000,660000,661000,662000,663000,664000,665000,666000,667000,668000,669000,670000,671000,672000,673000,674000,675000,676000,677000,678000,679000,680000,681000,682000,683000,684000,685000,686000,687000,688000,689000,690000,691000,692000,693000,694000,695000,696000,697000,698000,699000,700000,701000,702000,703000,704000,705000,706000,707000,708000,709000,710000,711000,712000,713000,714000,715000,716000,717000,718000,719000,720000,721000,722000,723000,724000,725000,726000,727000,728000,729000,730000,731000,732000,733000,734000,735000,736000,737000,738000,739000,740000,741000,742000,743000,744000,745000,746000,747000,748000,749000,750000,751000,752000,753000,754000,755000,756000,757000,758000,759000,760000,761000,762000,763000,764000,765000,766000,767000,768000,769000,770000,771000,772000,773000,774000,775000,776000,777000,778000,779000,780000,781000,782000,783000,784000,785000,786000,787000,788000,789000,790000,791000,792000,793000,794000,795000,796000,797000,798000,799000,800000,801000,802000,803000,804000,805000,806000,807000,808000,809000,810000,811000,812000,813000,814000,815000,816000,817000,818000,819000,820000,821000,822000,823000,824000,825000,826000,827000,828000,829000,830000,831000,832000,833000,834000,835000,836000,837000,838000,839000,840000,841000,842000,843000,844000,845000,846000,847000,848000,849000,850000,851000,852000,853000,854000,855000,856000,857000,858000,859000,860000,861000,862000,863000,864000,865000,866000,867000,868000,869000,870000,871000,872000,873000,874000,875000,876000,877000,878000,879000,880000,881000,882000,883000,884000,885000,886000,887000,888000,889000,890000,891000,892000,893000,894000,895000,896000,897000,898000,899000,900000,901000,902000,903000,904000,905000,906000,907000,908000,909000,910000,911000,912000,913000,914000,915000,916000,917000,918000,919000,920000,921000,922000,923000,924000,925000,926000,927000,928000,929000,930000,931000,932000,933000,934000,935000,936000,937000,938000,939000,940000,941000,942000,943000,944000,945000,946000,947000,948000,949000,950000,951000,952000,953000,954000,955000,956000,957000,958000,959000,960000,961000,962000,963000,964000,965000,966000,967000,968000,969000,970000,971000,972000,973000,974000,975000,976000,977000,978000,979000,980000,981000,982000,983000,984000,985000,986000,987000,988000,989000,990000,991000,992000,993000,994000,995000,996000,997000,998000,999000],"y":[null,-0.256,-0.232,-0.223,-0.31,-0.278,-0.278,-0.284,-0.267,-0.242,-0.253,-0.284,-0.24,-0.281,-0.275,-0.265,-0.255,-0.27,-0.289,-0.283,-0.289,-0.254,-0.24,-0.247,-0.259,-0.309,-0.256,-0.244,-0.22,-0.277,-0.27,-0.293,-0.282,-0.191,-0.283,-0.311,-0.31,-0.257,-0.31,-0.246,-0.302,-0.239,-0.272,-0.258,-0.266,-0.265,-0.234,-0.195,-0.292,-0.24,-0.257,-0.249,-0.33,-0.279,-0.287,-0.297,-0.243,-0.316,-0.191,-0.276,-0.255,-0.257,-0.25,-0.287,-0.221,-0.258,-0.286,-0.294,-0.222,-0.279,-0.254,-0.233,-0.227,-0.262,-0.24,-0.319,-0.257,-0.256,-0.244,-0.329,-0.248,-0.33,-0.273,-0.227,-0.235,-0.27,-0.247,-0.241,-0.229,-0.257,-0.212,-0.31,-0.242,-0.24,-0.266,-0.296,-0.267,-0.254,-0.266,-0.246,-0.292,-0.228,-0.276,-0.263,-0.209,-0.24,-0.283,-0.318,-0.221,-0.236,-0.182,-0.233,-0.312,-0.216,-0.256,-0.295,-0.285,-0.276,-0.29,-0.316,-0.285,-0.267,-0.327,-0.287,-0.241,-0.245,-0.259,-0.342,-0.292,-0.312,-0.243,-0.204,-0.209,-0.273,-0.251,-0.238,-0.204,-0.261,-0.251,-0.269,-0.252,-0.281,-0.2,-0.234,-0.319,-0.254,-0.275,-0.208,-0.237,-0.222,-0.256,-0.234,-0.222,-0.269,-0.227,-0.261,-0.296,-0.26,-0.219,-0.295,-0.28,-0.2,-0.27,-0.239,-0.212,-0.233,-0.252,-0.208,-0.203,-0.278,-0.265,-0.339,-0.244,-0.248,-0.272,-0.261,-0.333,-0.27,-0.289,-0.261,-0.323,-0.28,-0.279,-0.256,-0.229,-0.202,-0.272,-0.305,-0.261,-0.295,-0.264,-0.283,-0.289,-0.276,-0.274,-0.23,-0.272,-0.294,-0.317,-0.324,-0.282,-0.201,-0.25,-0.259,-0.283,-0.247,-0.271,-0.237,-0.246,-0.245,-0.303,-0.277,-0.282,-0.273,-0.305,-0.276,-0.266,-0.276,-0.236,-0.234,-0.319,-0.332,-0.216,-0.312,-0.211,-0.292,-0.259,-0.237,-0.251,-0.271,-0.218,-0.232,-0.31,-0.321,-0.227,-0.254,-0.205,-0.219,-0.219,-0.263,-0.255,-0.287,-0.28,-0.218,-0.245,-0.252,-0.236,-0.258,-0.269,-0.24,-0.289,-0.218,-0.281,-0.234,-0.253,-0.238,-0.284,-0.274,-0.229,-0.258,-0.24,-0.295,-0.257,-0.241,-0.257,-0.245,-0.237,-0.242,-0.33,-0.258,-0.229,-0.288,-0.266,-0.281,-0.253,-0.264,-0.243,-0.25,-0.246,-0.23,-0.277,-0.253,-0.224,-0.279,-0.273,-0.296,-0.271,-0.239,-0.266,-0.286,-0.263,-0.257,-0.215,-0.258,-0.251,-0.295,-0.23,-0.24,-0.176,-0.259,-0.262,-0.266,-0.237,-0.277,-0.277,-0.248,-0.285,-0.275,-0.262,-0.321,-0.268,-0.25,-0.206,-0.242,-0.278,-0.237,-0.283,-0.234,-0.259,-0.188,-0.282,-0.263,-0.266,-0.241,-0.249,-0.307,-0.3,-0.235,-0.251,-0.259,-0.242,-0.295,-0.256,-0.289,-0.24,-0.243,-0.296,-0.257,-0.217,-0.257,-0.251,-0.265,-0.266,-0.247,-0.288,-0.23,-0.289,-0.276,-0.24,-0.183,-0.261,-0.266,-0.265,-0.264,-0.312,-0.278,-0.207,-0.243,-0.247,-0.261,-0.202,-0.256,-0.228,-0.298,-0.197,-0.294,-0.312,-0.284,-0.262,-0.258,-0.277,-0.254,-0.28,-0.271,-0.293,-0.224,-0.262,-0.311,-0.241,-0.223,-0.265,-0.287,-0.238,-0.256,-0.302,-0.235,-0.228,-0.212,-0.235,-0.256,-0.219,-0.265,-0.27,-0.249,-0.299,-0.249,-0.294,-0.261,-0.287,-0.26,-0.257,-0.275,-0.237,-0.284,-0.259,-0.229,-0.289,-0.228,-0.227,-0.243,-0.269,-0.257,-0.284,-0.264,-0.257,-0.254,-0.25,-0.311,-0.217,-0.25,-0.317,-0.276,-0.275,-0.277,-0.258,-0.266,-0.309,-0.327,-0.275,-0.329,-0.293,-0.22,-0.217,-0.264,-0.267,-0.262,-0.245,-0.234,-0.277,-0.235,-0.27,-0.209,-0.284,-0.276,-0.277,-0.2,-0.236,-0.241,-0.263,-0.272,-0.286,-0.271,-0.249,-0.247,-0.238,-0.269,-0.277,-0.281,-0.279,-0.255,-0.221,-0.232,-0.317,-0.264,-0.299,-0.231,-0.259,-0.25,-0.259,-0.257,-0.249,-0.288,-0.284,-0.259,-0.25,-0.262,-0.277,-0.225,-0.303,-0.254,-0.268,-0.259,-0.272,-0.196,-0.255,-0.238,-0.287,-0.286,-0.249,-0.34,-0.27,-0.216,-0.25,-0.269,-0.271,-0.285,-0.287,-0.246,-0.267,-0.265,-0.254,-0.307,-0.224,-0.264,-0.238,-0.242,-0.251,-0.239,-0.326,-0.215,-0.285,-0.249,-0.286,-0.282,-0.22,-0.252,-0.259,-0.202,-0.269,-0.208,-0.256,-0.27,-0.237,-0.252,-0.286,-0.327,-0.235,-0.244,-0.256,-0.323,-0.315,-0.301,-0.292,-0.289,-0.192,-0.204,-0.265,-0.271,-0.221,-0.289,-0.232,-0.285,-0.299,-0.259,-0.272,-0.28,-0.211,-0.302,-0.261,-0.231,-0.259,-0.256,-0.34,-0.282,-0.267,-0.247,-0.236,-0.239,-0.288,-0.273,-0.277,-0.257,-0.252,-0.259,-0.244,-0.24,-0.214,-0.266,-0.257,-0.272,-0.236,-0.285,-0.282,-0.305,-0.293,-0.222,-0.218,-0.28,-0.228,-0.254,-0.223,-0.233,-0.291,-0.239,-0.279,-0.306,-0.28,-0.296,-0.239,-0.29,-0.236,-0.269,-0.31,-0.257,-0.261,-0.242,-0.298,-0.262,-0.239,-0.204,-0.268,-0.253,-0.264,-0.204,-0.256,-0.271,-0.221,-0.277,-0.229,-0.229,-0.225,-0.263,-0.205,-0.191,-0.297,-0.263,-0.254,-0.256,-0.218,-0.211,-0.276,-0.195,-0.254,-0.291,-0.274,-0.214,-0.272,-0.263,-0.244,-0.225,-0.23,-0.246,-0.217,-0.257,-0.28,-0.266,-0.257,-0.241,-0.274,-0.267,-0.261,-0.241,-0.207,-0.229,-0.28,-0.262,-0.249,-0.279,-0.252,-0.223,-0.262,-0.253,-0.269,-0.233,-0.251,-0.252,-0.244,-0.261,-0.223,-0.298,-0.191,-0.28,-0.212,-0.267,-0.258,-0.276,-0.271,-0.323,-0.288,-0.283,-0.231,-0.326,-0.229,-0.204,-0.27,-0.203,-0.27,-0.294,-0.267,-0.246,-0.244,-0.25,-0.226,-0.286,-0.256,-0.28,-0.269,-0.254,-0.217,-0.244,-0.287,-0.261,-0.26,-0.271,-0.294,-0.228,-0.256,-0.248,-0.283,-0.259,-0.261,-0.204,-0.267,-0.306,-0.256,-0.24,-0.276,-0.24,-0.241,-0.264,-0.264,-0.23,-0.291,-0.339,-0.255,-0.24,-0.262,-0.28,-0.241,-0.309,-0.298,-0.227,-0.354,-0.336,-0.223,-0.218,-0.265,-0.292,-0.26,-0.288,-0.236,-0.267,-0.263,-0.254,-0.292,-0.291,-0.269,-0.23,-0.269,-0.242,-0.229,-0.266,-0.335,-0.264,-0.248,-0.259,-0.239,-0.242,-0.249,-0.211,-0.294,-0.242,-0.284,-0.271,-0.24,-0.282,-0.221,-0.305,-0.255,-0.255,-0.272,-0.265,-0.217,-0.296,-0.292,-0.268,-0.23,-0.18,-0.29,-0.256,-0.277,-0.233,-0.243,-0.215,-0.204,-0.3,-0.267,-0.248,-0.309,-0.238,-0.235,-0.287,-0.262,-0.31,-0.268,-0.27,-0.215,-0.246,-0.268,-0.254,-0.243,-0.239,-0.331,-0.317,-0.268,-0.262,-0.23,-0.237,-0.242,-0.29,-0.231,-0.282,-0.257,-0.22,-0.223,-0.211,-0.263,-0.243,-0.338,-0.265,-0.233,-0.312,-0.235,-0.276,-0.262,-0.226,-0.249,-0.25,-0.278,-0.262,-0.279,-0.283,-0.24,-0.233,-0.255,-0.272,-0.29,-0.235,-0.208,-0.273,-0.257,-0.229,-0.263,-0.221,-0.283,-0.257,-0.284,-0.279,-0.259,-0.238,-0.213,-0.309,-0.238,-0.254,-0.31,-0.299,-0.246,-0.295,-0.195,-0.283,-0.244,-0.25,-0.233,-0.282,-0.256,-0.199,-0.274,-0.24,-0.286,-0.263,-0.318,-0.301,-0.259,-0.237,-0.259,-0.255,-0.273,-0.275,-0.202,-0.293,-0.271,-0.24,-0.311,-0.228,-0.237,-0.244,-0.263,-0.3,-0.276,-0.255,-0.177,-0.248,-0.26,-0.314,-0.301,-0.233,-0.276,-0.296,-0.264,-0.277,-0.244,-0.273,-0.26,-0.253,-0.232,-0.262,-0.257,-0.24,-0.258,-0.211,-0.307,-0.268,-0.289,-0.26,-0.242,-0.24,-0.257,-0.275,-0.256,-0.29,-0.279,-0.289,-0.236,-0.246,-0.253,-0.269,-0.222,-0.24,-0.301,-0.267,-0.257,-0.259,-0.256,-0.258,-0.252,-0.291,-0.25,-0.224,-0.224,-0.249,-0.255,-0.224,-0.238,-0.239,-0.238,-0.277,-0.271,-0.245,-0.282,-0.311,-0.315,-0.247,-0.284,-0.255,-0.267,-0.278,-0.292,-0.213,-0.26,-0.2,-0.232,-0.292,-0.307,-0.24,-0.228,-0.25,-0.281,-0.286,-0.282,-0.241,-0.247,-0.271,-0.218,-0.226,-0.236,-0.283,-0.241,-0.257,-0.226,-0.236,-0.279,-0.259,-0.251,-0.264,-0.292,-0.255,-0.221,-0.265,-0.181,-0.287,-0.281,-0.226,-0.27,-0.302,-0.256,-0.184,-0.287,-0.268,-0.266,-0.274,-0.218,-0.251,-0.305,-0.253,-0.22,-0.233,-0.226,-0.261,-0.263,-0.294],"type":"scatter"},{"hovertemplate":"Method: Q-Learning\u003cbr\u003eEpisode: %{x}\u003cbr\u003eReturn: %{y}\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#e7e3cb"},"name":"Q-Learning","x":[0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000,61000,62000,63000,64000,65000,66000,67000,68000,69000,70000,71000,72000,73000,74000,75000,76000,77000,78000,79000,80000,81000,82000,83000,84000,85000,86000,87000,88000,89000,90000,91000,92000,93000,94000,95000,96000,97000,98000,99000,100000,101000,102000,103000,104000,105000,106000,107000,108000,109000,110000,111000,112000,113000,114000,115000,116000,117000,118000,119000,120000,121000,122000,123000,124000,125000,126000,127000,128000,129000,130000,131000,132000,133000,134000,135000,136000,137000,138000,139000,140000,141000,142000,143000,144000,145000,146000,147000,148000,149000,150000,151000,152000,153000,154000,155000,156000,157000,158000,159000,160000,161000,162000,163000,164000,165000,166000,167000,168000,169000,170000,171000,172000,173000,174000,175000,176000,177000,178000,179000,180000,181000,182000,183000,184000,185000,186000,187000,188000,189000,190000,191000,192000,193000,194000,195000,196000,197000,198000,199000,200000,201000,202000,203000,204000,205000,206000,207000,208000,209000,210000,211000,212000,213000,214000,215000,216000,217000,218000,219000,220000,221000,222000,223000,224000,225000,226000,227000,228000,229000,230000,231000,232000,233000,234000,235000,236000,237000,238000,239000,240000,241000,242000,243000,244000,245000,246000,247000,248000,249000,250000,251000,252000,253000,254000,255000,256000,257000,258000,259000,260000,261000,262000,263000,264000,265000,266000,267000,268000,269000,270000,271000,272000,273000,274000,275000,276000,277000,278000,279000,280000,281000,282000,283000,284000,285000,286000,287000,288000,289000,290000,291000,292000,293000,294000,295000,296000,297000,298000,299000,300000,301000,302000,303000,304000,305000,306000,307000,308000,309000,310000,311000,312000,313000,314000,315000,316000,317000,318000,319000,320000,321000,322000,323000,324000,325000,326000,327000,328000,329000,330000,331000,332000,333000,334000,335000,336000,337000,338000,339000,340000,341000,342000,343000,344000,345000,346000,347000,348000,349000,350000,351000,352000,353000,354000,355000,356000,357000,358000,359000,360000,361000,362000,363000,364000,365000,366000,367000,368000,369000,370000,371000,372000,373000,374000,375000,376000,377000,378000,379000,380000,381000,382000,383000,384000,385000,386000,387000,388000,389000,390000,391000,392000,393000,394000,395000,396000,397000,398000,399000,400000,401000,402000,403000,404000,405000,406000,407000,408000,409000,410000,411000,412000,413000,414000,415000,416000,417000,418000,419000,420000,421000,422000,423000,424000,425000,426000,427000,428000,429000,430000,431000,432000,433000,434000,435000,436000,437000,438000,439000,440000,441000,442000,443000,444000,445000,446000,447000,448000,449000,450000,451000,452000,453000,454000,455000,456000,457000,458000,459000,460000,461000,462000,463000,464000,465000,466000,467000,468000,469000,470000,471000,472000,473000,474000,475000,476000,477000,478000,479000,480000,481000,482000,483000,484000,485000,486000,487000,488000,489000,490000,491000,492000,493000,494000,495000,496000,497000,498000,499000,500000,501000,502000,503000,504000,505000,506000,507000,508000,509000,510000,511000,512000,513000,514000,515000,516000,517000,518000,519000,520000,521000,522000,523000,524000,525000,526000,527000,528000,529000,530000,531000,532000,533000,534000,535000,536000,537000,538000,539000,540000,541000,542000,543000,544000,545000,546000,547000,548000,549000,550000,551000,552000,553000,554000,555000,556000,557000,558000,559000,560000,561000,562000,563000,564000,565000,566000,567000,568000,569000,570000,571000,572000,573000,574000,575000,576000,577000,578000,579000,580000,581000,582000,583000,584000,585000,586000,587000,588000,589000,590000,591000,592000,593000,594000,595000,596000,597000,598000,599000,600000,601000,602000,603000,604000,605000,606000,607000,608000,609000,610000,611000,612000,613000,614000,615000,616000,617000,618000,619000,620000,621000,622000,623000,624000,625000,626000,627000,628000,629000,630000,631000,632000,633000,634000,635000,636000,637000,638000,639000,640000,641000,642000,643000,644000,645000,646000,647000,648000,649000,650000,651000,652000,653000,654000,655000,656000,657000,658000,659000,660000,661000,662000,663000,664000,665000,666000,667000,668000,669000,670000,671000,672000,673000,674000,675000,676000,677000,678000,679000,680000,681000,682000,683000,684000,685000,686000,687000,688000,689000,690000,691000,692000,693000,694000,695000,696000,697000,698000,699000,700000,701000,702000,703000,704000,705000,706000,707000,708000,709000,710000,711000,712000,713000,714000,715000,716000,717000,718000,719000,720000,721000,722000,723000,724000,725000,726000,727000,728000,729000,730000,731000,732000,733000,734000,735000,736000,737000,738000,739000,740000,741000,742000,743000,744000,745000,746000,747000,748000,749000,750000,751000,752000,753000,754000,755000,756000,757000,758000,759000,760000,761000,762000,763000,764000,765000,766000,767000,768000,769000,770000,771000,772000,773000,774000,775000,776000,777000,778000,779000,780000,781000,782000,783000,784000,785000,786000,787000,788000,789000,790000,791000,792000,793000,794000,795000,796000,797000,798000,799000,800000,801000,802000,803000,804000,805000,806000,807000,808000,809000,810000,811000,812000,813000,814000,815000,816000,817000,818000,819000,820000,821000,822000,823000,824000,825000,826000,827000,828000,829000,830000,831000,832000,833000,834000,835000,836000,837000,838000,839000,840000,841000,842000,843000,844000,845000,846000,847000,848000,849000,850000,851000,852000,853000,854000,855000,856000,857000,858000,859000,860000,861000,862000,863000,864000,865000,866000,867000,868000,869000,870000,871000,872000,873000,874000,875000,876000,877000,878000,879000,880000,881000,882000,883000,884000,885000,886000,887000,888000,889000,890000,891000,892000,893000,894000,895000,896000,897000,898000,899000,900000,901000,902000,903000,904000,905000,906000,907000,908000,909000,910000,911000,912000,913000,914000,915000,916000,917000,918000,919000,920000,921000,922000,923000,924000,925000,926000,927000,928000,929000,930000,931000,932000,933000,934000,935000,936000,937000,938000,939000,940000,941000,942000,943000,944000,945000,946000,947000,948000,949000,950000,951000,952000,953000,954000,955000,956000,957000,958000,959000,960000,961000,962000,963000,964000,965000,966000,967000,968000,969000,970000,971000,972000,973000,974000,975000,976000,977000,978000,979000,980000,981000,982000,983000,984000,985000,986000,987000,988000,989000,990000,991000,992000,993000,994000,995000,996000,997000,998000,999000],"y":[null,-0.387,-0.369,-0.374,-0.397,-0.41,-0.431,-0.396,-0.448,-0.364,-0.383,-0.393,-0.417,-0.387,-0.388,-0.392,-0.45,-0.405,-0.348,-0.367,-0.397,-0.333,-0.381,-0.393,-0.389,-0.393,-0.407,-0.343,-0.346,-0.357,-0.418,-0.341,-0.354,-0.447,-0.389,-0.385,-0.422,-0.393,-0.388,-0.387,-0.402,-0.393,-0.413,-0.412,-0.316,-0.345,-0.371,-0.357,-0.393,-0.387,-0.296,-0.343,-0.402,-0.357,-0.373,-0.341,-0.35,-0.372,-0.399,-0.334,-0.369,-0.352,-0.382,-0.343,-0.422,-0.357,-0.386,-0.36,-0.326,-0.328,-0.42,-0.378,-0.322,-0.375,-0.369,-0.382,-0.388,-0.357,-0.345,-0.401,-0.345,-0.404,-0.312,-0.375,-0.396,-0.394,-0.37,-0.342,-0.387,-0.327,-0.327,-0.419,-0.317,-0.366,-0.338,-0.388,-0.373,-0.366,-0.406,-0.368,-0.363,-0.41,-0.324,-0.38,-0.396,-0.387,-0.342,-0.308,-0.362,-0.351,-0.361,-0.381,-0.354,-0.379,-0.354,-0.381,-0.371,-0.403,-0.377,-0.391,-0.329,-0.386,-0.367,-0.362,-0.326,-0.339,-0.339,-0.362,-0.368,-0.333,-0.342,-0.313,-0.363,-0.369,-0.303,-0.356,-0.366,-0.314,-0.321,-0.341,-0.34,-0.301,-0.332,-0.33,-0.331,-0.373,-0.296,-0.242,-0.293,-0.337,-0.288,-0.328,-0.376,-0.384,-0.351,-0.375,-0.297,-0.368,-0.31,-0.368,-0.368,-0.332,-0.339,-0.356,-0.33,-0.325,-0.315,-0.409,-0.353,-0.317,-0.337,-0.36,-0.355,-0.382,-0.351,-0.364,-0.313,-0.383,-0.308,-0.31,-0.323,-0.308,-0.34,-0.322,-0.32,-0.345,-0.346,-0.326,-0.313,-0.361,-0.332,-0.277,-0.386,-0.363,-0.323,-0.374,-0.333,-0.313,-0.31,-0.346,-0.251,-0.308,-0.33,-0.39,-0.336,-0.333,-0.367,-0.303,-0.326,-0.342,-0.314,-0.312,-0.392,-0.358,-0.279,-0.286,-0.333,-0.322,-0.324,-0.347,-0.345,-0.318,-0.344,-0.288,-0.287,-0.311,-0.34,-0.331,-0.342,-0.317,-0.401,-0.282,-0.334,-0.322,-0.347,-0.331,-0.301,-0.309,-0.281,-0.33,-0.345,-0.308,-0.276,-0.315,-0.364,-0.264,-0.294,-0.346,-0.297,-0.331,-0.294,-0.321,-0.296,-0.296,-0.363,-0.29,-0.335,-0.347,-0.307,-0.299,-0.246,-0.287,-0.29,-0.331,-0.252,-0.325,-0.312,-0.292,-0.328,-0.374,-0.33,-0.279,-0.304,-0.357,-0.318,-0.272,-0.324,-0.328,-0.314,-0.336,-0.292,-0.343,-0.361,-0.336,-0.284,-0.284,-0.302,-0.303,-0.305,-0.384,-0.292,-0.306,-0.369,-0.277,-0.305,-0.285,-0.31,-0.302,-0.284,-0.295,-0.331,-0.258,-0.27,-0.256,-0.308,-0.262,-0.319,-0.287,-0.336,-0.299,-0.294,-0.285,-0.304,-0.285,-0.264,-0.304,-0.27,-0.282,-0.282,-0.31,-0.307,-0.307,-0.27,-0.309,-0.277,-0.284,-0.342,-0.294,-0.298,-0.28,-0.295,-0.261,-0.278,-0.264,-0.302,-0.271,-0.277,-0.318,-0.313,-0.25,-0.206,-0.302,-0.282,-0.269,-0.285,-0.289,-0.281,-0.292,-0.319,-0.297,-0.242,-0.269,-0.329,-0.314,-0.278,-0.274,-0.335,-0.302,-0.303,-0.263,-0.312,-0.307,-0.27,-0.337,-0.274,-0.242,-0.217,-0.249,-0.314,-0.302,-0.255,-0.242,-0.293,-0.259,-0.312,-0.257,-0.272,-0.271,-0.252,-0.295,-0.288,-0.265,-0.288,-0.193,-0.331,-0.269,-0.279,-0.29,-0.247,-0.256,-0.243,-0.288,-0.271,-0.233,-0.228,-0.26,-0.28,-0.25,-0.29,-0.285,-0.282,-0.281,-0.276,-0.186,-0.249,-0.286,-0.28,-0.3,-0.294,-0.256,-0.21,-0.26,-0.246,-0.248,-0.28,-0.218,-0.27,-0.305,-0.314,-0.285,-0.312,-0.245,-0.233,-0.258,-0.268,-0.239,-0.264,-0.282,-0.24,-0.306,-0.266,-0.258,-0.311,-0.229,-0.234,-0.276,-0.276,-0.301,-0.177,-0.258,-0.245,-0.278,-0.233,-0.328,-0.268,-0.318,-0.272,-0.286,-0.211,-0.256,-0.222,-0.222,-0.21,-0.252,-0.239,-0.24,-0.223,-0.28,-0.278,-0.251,-0.203,-0.268,-0.218,-0.248,-0.218,-0.247,-0.243,-0.2,-0.298,-0.225,-0.21,-0.288,-0.288,-0.256,-0.248,-0.126,-0.267,-0.273,-0.183,-0.204,-0.244,-0.202,-0.288,-0.296,-0.237,-0.248,-0.246,-0.253,-0.223,-0.209,-0.248,-0.258,-0.269,-0.259,-0.202,-0.215,-0.259,-0.32,-0.285,-0.153,-0.255,-0.234,-0.214,-0.243,-0.226,-0.306,-0.22,-0.213,-0.191,-0.247,-0.262,-0.224,-0.273,-0.234,-0.244,-0.215,-0.225,-0.271,-0.21,-0.248,-0.192,-0.199,-0.227,-0.211,-0.155,-0.189,-0.243,-0.231,-0.218,-0.224,-0.227,-0.212,-0.218,-0.282,-0.231,-0.234,-0.178,-0.244,-0.206,-0.196,-0.234,-0.27,-0.245,-0.244,-0.227,-0.198,-0.283,-0.22,-0.22,-0.227,-0.252,-0.217,-0.195,-0.163,-0.255,-0.24,-0.235,-0.221,-0.282,-0.226,-0.209,-0.237,-0.16,-0.228,-0.196,-0.251,-0.228,-0.24,-0.177,-0.236,-0.192,-0.231,-0.183,-0.251,-0.27,-0.246,-0.247,-0.219,-0.189,-0.239,-0.246,-0.226,-0.177,-0.14,-0.238,-0.205,-0.218,-0.196,-0.223,-0.224,-0.201,-0.241,-0.175,-0.21,-0.216,-0.183,-0.203,-0.174,-0.248,-0.172,-0.223,-0.245,-0.221,-0.223,-0.196,-0.188,-0.238,-0.167,-0.167,-0.203,-0.218,-0.188,-0.208,-0.149,-0.177,-0.2,-0.198,-0.189,-0.2,-0.214,-0.155,-0.167,-0.129,-0.202,-0.193,-0.171,-0.196,-0.181,-0.174,-0.258,-0.172,-0.224,-0.2,-0.204,-0.212,-0.219,-0.152,-0.237,-0.23,-0.202,-0.183,-0.2,-0.205,-0.15,-0.193,-0.25,-0.237,-0.181,-0.209,-0.21,-0.182,-0.185,-0.184,-0.182,-0.229,-0.175,-0.15,-0.179,-0.18,-0.172,-0.177,-0.225,-0.157,-0.209,-0.202,-0.191,-0.202,-0.141,-0.242,-0.235,-0.187,-0.181,-0.157,-0.161,-0.189,-0.217,-0.179,-0.216,-0.141,-0.182,-0.18,-0.225,-0.199,-0.178,-0.155,-0.165,-0.142,-0.196,-0.18,-0.161,-0.182,-0.173,-0.173,-0.156,-0.183,-0.183,-0.19,-0.148,-0.172,-0.157,-0.176,-0.207,-0.121,-0.152,-0.17,-0.171,-0.186,-0.179,-0.117,-0.165,-0.184,-0.193,-0.168,-0.184,-0.169,-0.179,-0.187,-0.156,-0.17,-0.165,-0.123,-0.194,-0.113,-0.189,-0.164,-0.155,-0.162,-0.181,-0.184,-0.147,-0.163,-0.172,-0.146,-0.082,-0.194,-0.192,-0.158,-0.186,-0.164,-0.134,-0.173,-0.147,-0.22,-0.106,-0.183,-0.159,-0.219,-0.109,-0.178,-0.158,-0.201,-0.14,-0.186,-0.158,-0.208,-0.146,-0.189,-0.09,-0.155,-0.128,-0.18,-0.139,-0.145,-0.169,-0.205,-0.132,-0.138,-0.144,-0.169,-0.188,-0.175,-0.138,-0.151,-0.127,-0.125,-0.207,-0.194,-0.153,-0.131,-0.161,-0.108,-0.16,-0.178,-0.177,-0.193,-0.138,-0.183,-0.119,-0.092,-0.158,-0.129,-0.156,-0.131,-0.177,-0.141,-0.149,-0.116,-0.066,-0.14,-0.162,-0.103,-0.137,-0.143,-0.147,-0.178,-0.181,-0.147,-0.141,-0.121,-0.091,-0.117,-0.158,-0.125,-0.165,-0.143,-0.182,-0.139,-0.113,-0.153,-0.161,-0.098,-0.137,-0.101,-0.119,-0.095,-0.087,-0.183,-0.197,-0.13,-0.176,-0.146,-0.193,-0.17,-0.099,-0.137,-0.084,-0.125,-0.184,-0.08,-0.11,-0.116,-0.14,-0.128,-0.171,-0.163,-0.122,-0.131,-0.167,-0.175,-0.132,-0.124,-0.1,-0.112,-0.175,-0.134,-0.09,-0.138,-0.13,-0.047,-0.128,-0.113,-0.122,-0.074,-0.119,-0.132,-0.119,-0.145,-0.133,-0.095,-0.109,-0.128,-0.206,-0.147,-0.135,-0.11,-0.136,-0.142,-0.089,-0.086,-0.139,-0.109,-0.118,-0.12,-0.143,-0.135,-0.074,-0.093,-0.105,-0.188,-0.112,-0.117,-0.092,-0.159,-0.149,-0.071,-0.134,-0.117,-0.118,-0.108,-0.097,-0.108,-0.115,-0.118,-0.091,-0.104,-0.091,-0.144,-0.095,-0.095,-0.115,-0.098,-0.097,-0.069,-0.101,-0.121,-0.13,-0.18,-0.098,-0.107,-0.092,-0.09,-0.114,-0.156,-0.098,-0.095,-0.094,-0.13,-0.106,-0.156,-0.094,-0.115,-0.118,-0.068,-0.098,-0.142,-0.087,-0.163,-0.102,-0.103,-0.093,-0.086,-0.08,-0.094,-0.094,-0.062,-0.11,-0.09,-0.094,-0.061,-0.073,-0.107,-0.096,-0.07,-0.098,-0.088,-0.086,-0.122,-0.134,-0.052,-0.144,-0.05,-0.11,-0.097,-0.121,-0.097,-0.147,-0.1,-0.083,-0.094,-0.078,-0.114,-0.04,-0.141,-0.122,-0.042,-0.081,-0.118,-0.126,-0.042,-0.095,-0.092,-0.065,-0.103,-0.103,-0.152,-0.085,-0.066,-0.123,-0.069,-0.069,-0.169,-0.116,-0.098,-0.047,-0.089,-0.108,-0.125,-0.064,-0.123,-0.116],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Episode returns","font":{"size":16},"x":0},"yaxis":{"range":[-0.5,0],"showline":false,"gridwidth":2,"gridcolor":"#fafafa","zerolinecolor":"#fafafa"},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"legend":{"orientation":"h","itemsizing":"constant","x":0.05,"y":0.9,"yanchor":"middle"},"paper_bgcolor":"transparent","plot_bgcolor":"transparent","xaxis":{"showline":true,"linewidth":2,"linecolor":"black"}},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-6"><div>                            <div id="8ce48e14-b1bb-4a89-8a58-b54c43d57a24" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8ce48e14-b1bb-4a89-8a58-b54c43d57a24")) {                    Plotly.newPlot(                        "8ce48e14-b1bb-4a89-8a58-b54c43d57a24",                        [{"hovertemplate":"Method: Monte Carlo ES\u003cbr\u003eEpisode: %{x}\u003cbr\u003eLength: %{y}\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#d7d6cc"},"name":"Monte Carlo ES","showlegend":false,"x":[0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000,61000,62000,63000,64000,65000,66000,67000,68000,69000,70000,71000,72000,73000,74000,75000,76000,77000,78000,79000,80000,81000,82000,83000,84000,85000,86000,87000,88000,89000,90000,91000,92000,93000,94000,95000,96000,97000,98000,99000,100000,101000,102000,103000,104000,105000,106000,107000,108000,109000,110000,111000,112000,113000,114000,115000,116000,117000,118000,119000,120000,121000,122000,123000,124000,125000,126000,127000,128000,129000,130000,131000,132000,133000,134000,135000,136000,137000,138000,139000,140000,141000,142000,143000,144000,145000,146000,147000,148000,149000,150000,151000,152000,153000,154000,155000,156000,157000,158000,159000,160000,161000,162000,163000,164000,165000,166000,167000,168000,169000,170000,171000,172000,173000,174000,175000,176000,177000,178000,179000,180000,181000,182000,183000,184000,185000,186000,187000,188000,189000,190000,191000,192000,193000,194000,195000,196000,197000,198000,199000,200000,201000,202000,203000,204000,205000,206000,207000,208000,209000,210000,211000,212000,213000,214000,215000,216000,217000,218000,219000,220000,221000,222000,223000,224000,225000,226000,227000,228000,229000,230000,231000,232000,233000,234000,235000,236000,237000,238000,239000,240000,241000,242000,243000,244000,245000,246000,247000,248000,249000,250000,251000,252000,253000,254000,255000,256000,257000,258000,259000,260000,261000,262000,263000,264000,265000,266000,267000,268000,269000,270000,271000,272000,273000,274000,275000,276000,277000,278000,279000,280000,281000,282000,283000,284000,285000,286000,287000,288000,289000,290000,291000,292000,293000,294000,295000,296000,297000,298000,299000,300000,301000,302000,303000,304000,305000,306000,307000,308000,309000,310000,311000,312000,313000,314000,315000,316000,317000,318000,319000,320000,321000,322000,323000,324000,325000,326000,327000,328000,329000,330000,331000,332000,333000,334000,335000,336000,337000,338000,339000,340000,341000,342000,343000,344000,345000,346000,347000,348000,349000,350000,351000,352000,353000,354000,355000,356000,357000,358000,359000,360000,361000,362000,363000,364000,365000,366000,367000,368000,369000,370000,371000,372000,373000,374000,375000,376000,377000,378000,379000,380000,381000,382000,383000,384000,385000,386000,387000,388000,389000,390000,391000,392000,393000,394000,395000,396000,397000,398000,399000,400000,401000,402000,403000,404000,405000,406000,407000,408000,409000,410000,411000,412000,413000,414000,415000,416000,417000,418000,419000,420000,421000,422000,423000,424000,425000,426000,427000,428000,429000,430000,431000,432000,433000,434000,435000,436000,437000,438000,439000,440000,441000,442000,443000,444000,445000,446000,447000,448000,449000,450000,451000,452000,453000,454000,455000,456000,457000,458000,459000,460000,461000,462000,463000,464000,465000,466000,467000,468000,469000,470000,471000,472000,473000,474000,475000,476000,477000,478000,479000,480000,481000,482000,483000,484000,485000,486000,487000,488000,489000,490000,491000,492000,493000,494000,495000,496000,497000,498000,499000,500000,501000,502000,503000,504000,505000,506000,507000,508000,509000,510000,511000,512000,513000,514000,515000,516000,517000,518000,519000,520000,521000,522000,523000,524000,525000,526000,527000,528000,529000,530000,531000,532000,533000,534000,535000,536000,537000,538000,539000,540000,541000,542000,543000,544000,545000,546000,547000,548000,549000,550000,551000,552000,553000,554000,555000,556000,557000,558000,559000,560000,561000,562000,563000,564000,565000,566000,567000,568000,569000,570000,571000,572000,573000,574000,575000,576000,577000,578000,579000,580000,581000,582000,583000,584000,585000,586000,587000,588000,589000,590000,591000,592000,593000,594000,595000,596000,597000,598000,599000,600000,601000,602000,603000,604000,605000,606000,607000,608000,609000,610000,611000,612000,613000,614000,615000,616000,617000,618000,619000,620000,621000,622000,623000,624000,625000,626000,627000,628000,629000,630000,631000,632000,633000,634000,635000,636000,637000,638000,639000,640000,641000,642000,643000,644000,645000,646000,647000,648000,649000,650000,651000,652000,653000,654000,655000,656000,657000,658000,659000,660000,661000,662000,663000,664000,665000,666000,667000,668000,669000,670000,671000,672000,673000,674000,675000,676000,677000,678000,679000,680000,681000,682000,683000,684000,685000,686000,687000,688000,689000,690000,691000,692000,693000,694000,695000,696000,697000,698000,699000,700000,701000,702000,703000,704000,705000,706000,707000,708000,709000,710000,711000,712000,713000,714000,715000,716000,717000,718000,719000,720000,721000,722000,723000,724000,725000,726000,727000,728000,729000,730000,731000,732000,733000,734000,735000,736000,737000,738000,739000,740000,741000,742000,743000,744000,745000,746000,747000,748000,749000,750000,751000,752000,753000,754000,755000,756000,757000,758000,759000,760000,761000,762000,763000,764000,765000,766000,767000,768000,769000,770000,771000,772000,773000,774000,775000,776000,777000,778000,779000,780000,781000,782000,783000,784000,785000,786000,787000,788000,789000,790000,791000,792000,793000,794000,795000,796000,797000,798000,799000,800000,801000,802000,803000,804000,805000,806000,807000,808000,809000,810000,811000,812000,813000,814000,815000,816000,817000,818000,819000,820000,821000,822000,823000,824000,825000,826000,827000,828000,829000,830000,831000,832000,833000,834000,835000,836000,837000,838000,839000,840000,841000,842000,843000,844000,845000,846000,847000,848000,849000,850000,851000,852000,853000,854000,855000,856000,857000,858000,859000,860000,861000,862000,863000,864000,865000,866000,867000,868000,869000,870000,871000,872000,873000,874000,875000,876000,877000,878000,879000,880000,881000,882000,883000,884000,885000,886000,887000,888000,889000,890000,891000,892000,893000,894000,895000,896000,897000,898000,899000,900000,901000,902000,903000,904000,905000,906000,907000,908000,909000,910000,911000,912000,913000,914000,915000,916000,917000,918000,919000,920000,921000,922000,923000,924000,925000,926000,927000,928000,929000,930000,931000,932000,933000,934000,935000,936000,937000,938000,939000,940000,941000,942000,943000,944000,945000,946000,947000,948000,949000,950000,951000,952000,953000,954000,955000,956000,957000,958000,959000,960000,961000,962000,963000,964000,965000,966000,967000,968000,969000,970000,971000,972000,973000,974000,975000,976000,977000,978000,979000,980000,981000,982000,983000,984000,985000,986000,987000,988000,989000,990000,991000,992000,993000,994000,995000,996000,997000,998000,999000],"y":[null,1.362,1.365,1.371,1.358,1.365,1.379,1.353,1.376,1.368,1.357,1.365,1.362,1.386,1.33,1.39,1.371,1.348,1.371,1.363,1.379,1.41,1.381,1.354,1.343,1.373,1.391,1.357,1.358,1.369,1.386,1.376,1.354,1.355,1.387,1.372,1.372,1.363,1.354,1.364,1.398,1.387,1.373,1.376,1.393,1.375,1.385,1.384,1.357,1.367,1.379,1.407,1.39,1.394,1.351,1.384,1.36,1.332,1.355,1.371,1.363,1.395,1.407,1.369,1.356,1.336,1.333,1.389,1.363,1.373,1.342,1.378,1.405,1.336,1.43,1.357,1.378,1.378,1.35,1.385,1.387,1.372,1.373,1.392,1.387,1.355,1.376,1.356,1.368,1.361,1.403,1.358,1.4,1.355,1.356,1.385,1.364,1.386,1.388,1.387,1.368,1.39,1.357,1.356,1.383,1.388,1.342,1.377,1.383,1.391,1.374,1.369,1.365,1.391,1.368,1.335,1.354,1.375,1.358,1.359,1.371,1.392,1.365,1.375,1.369,1.36,1.342,1.332,1.381,1.367,1.371,1.373,1.377,1.357,1.361,1.364,1.354,1.379,1.387,1.403,1.39,1.388,1.387,1.356,1.347,1.357,1.381,1.363,1.398,1.386,1.352,1.355,1.361,1.374,1.395,1.381,1.365,1.374,1.402,1.386,1.379,1.391,1.34,1.363,1.379,1.379,1.344,1.365,1.394,1.385,1.374,1.374,1.365,1.397,1.372,1.354,1.362,1.354,1.355,1.384,1.312,1.361,1.369,1.35,1.364,1.365,1.36,1.346,1.377,1.347,1.389,1.384,1.389,1.362,1.397,1.373,1.372,1.349,1.345,1.384,1.371,1.35,1.378,1.376,1.347,1.377,1.375,1.356,1.41,1.369,1.349,1.368,1.379,1.388,1.349,1.345,1.364,1.34,1.365,1.357,1.34,1.366,1.381,1.358,1.347,1.347,1.361,1.366,1.421,1.394,1.37,1.4,1.345,1.36,1.359,1.388,1.358,1.375,1.373,1.38,1.369,1.365,1.357,1.353,1.378,1.363,1.349,1.363,1.361,1.376,1.351,1.384,1.361,1.378,1.352,1.395,1.343,1.368,1.374,1.349,1.366,1.37,1.354,1.351,1.383,1.383,1.339,1.367,1.364,1.382,1.364,1.344,1.36,1.359,1.362,1.35,1.361,1.339,1.367,1.372,1.379,1.381,1.394,1.371,1.327,1.401,1.382,1.366,1.387,1.337,1.385,1.42,1.369,1.401,1.376,1.348,1.365,1.391,1.369,1.356,1.372,1.363,1.401,1.372,1.395,1.365,1.351,1.366,1.353,1.344,1.371,1.371,1.389,1.385,1.381,1.363,1.394,1.369,1.377,1.394,1.363,1.367,1.352,1.401,1.38,1.381,1.337,1.344,1.381,1.363,1.371,1.361,1.381,1.394,1.382,1.406,1.365,1.388,1.395,1.406,1.374,1.379,1.359,1.336,1.333,1.378,1.411,1.401,1.368,1.385,1.374,1.375,1.351,1.367,1.361,1.375,1.394,1.373,1.417,1.399,1.382,1.386,1.391,1.356,1.386,1.349,1.358,1.331,1.365,1.372,1.342,1.382,1.373,1.366,1.361,1.352,1.376,1.384,1.413,1.38,1.388,1.409,1.391,1.374,1.4,1.368,1.393,1.373,1.346,1.395,1.394,1.41,1.411,1.398,1.343,1.341,1.389,1.368,1.391,1.354,1.376,1.366,1.38,1.39,1.366,1.364,1.368,1.4,1.366,1.362,1.369,1.359,1.383,1.384,1.386,1.378,1.399,1.391,1.4,1.352,1.359,1.398,1.348,1.359,1.384,1.333,1.365,1.375,1.363,1.357,1.355,1.399,1.413,1.369,1.379,1.38,1.383,1.386,1.385,1.385,1.362,1.357,1.342,1.339,1.359,1.371,1.391,1.369,1.36,1.363,1.38,1.352,1.359,1.372,1.414,1.363,1.381,1.342,1.373,1.397,1.385,1.418,1.362,1.393,1.363,1.377,1.347,1.369,1.397,1.362,1.367,1.386,1.385,1.35,1.364,1.392,1.331,1.373,1.391,1.352,1.387,1.407,1.357,1.376,1.354,1.362,1.364,1.347,1.407,1.348,1.336,1.402,1.394,1.353,1.412,1.374,1.358,1.379,1.383,1.379,1.377,1.356,1.384,1.39,1.362,1.366,1.379,1.403,1.343,1.426,1.36,1.38,1.344,1.345,1.426,1.33,1.368,1.385,1.398,1.377,1.362,1.353,1.373,1.408,1.367,1.352,1.382,1.393,1.365,1.406,1.404,1.364,1.404,1.397,1.425,1.378,1.372,1.386,1.361,1.344,1.391,1.385,1.361,1.369,1.352,1.368,1.378,1.376,1.352,1.41,1.389,1.354,1.377,1.374,1.349,1.376,1.377,1.378,1.365,1.367,1.39,1.38,1.394,1.381,1.379,1.352,1.368,1.396,1.337,1.372,1.345,1.347,1.404,1.364,1.346,1.387,1.382,1.356,1.363,1.381,1.381,1.387,1.392,1.412,1.393,1.383,1.364,1.376,1.354,1.374,1.4,1.377,1.395,1.413,1.362,1.408,1.396,1.374,1.365,1.371,1.377,1.382,1.335,1.362,1.377,1.387,1.408,1.342,1.38,1.363,1.385,1.364,1.363,1.376,1.407,1.4,1.383,1.364,1.4,1.415,1.353,1.373,1.374,1.362,1.357,1.372,1.391,1.377,1.365,1.388,1.393,1.363,1.374,1.35,1.371,1.387,1.389,1.375,1.397,1.362,1.37,1.385,1.392,1.348,1.387,1.38,1.365,1.372,1.431,1.368,1.395,1.378,1.361,1.355,1.358,1.364,1.356,1.4,1.385,1.366,1.39,1.406,1.404,1.34,1.39,1.38,1.372,1.354,1.32,1.371,1.367,1.362,1.374,1.387,1.373,1.368,1.383,1.37,1.346,1.376,1.39,1.367,1.393,1.357,1.354,1.429,1.377,1.376,1.351,1.371,1.354,1.375,1.372,1.367,1.358,1.388,1.384,1.354,1.382,1.348,1.327,1.386,1.349,1.358,1.356,1.371,1.39,1.436,1.372,1.398,1.383,1.383,1.377,1.388,1.358,1.394,1.352,1.37,1.393,1.365,1.335,1.372,1.364,1.385,1.359,1.389,1.379,1.336,1.394,1.396,1.374,1.353,1.367,1.38,1.384,1.36,1.35,1.382,1.358,1.351,1.401,1.355,1.384,1.364,1.36,1.392,1.343,1.387,1.383,1.369,1.385,1.383,1.364,1.385,1.376,1.373,1.375,1.382,1.38,1.349,1.374,1.359,1.4,1.389,1.367,1.381,1.398,1.363,1.348,1.372,1.361,1.384,1.404,1.43,1.393,1.349,1.383,1.365,1.368,1.424,1.378,1.359,1.38,1.366,1.384,1.357,1.379,1.351,1.361,1.369,1.386,1.393,1.361,1.356,1.366,1.376,1.366,1.378,1.379,1.393,1.388,1.378,1.367,1.404,1.37,1.365,1.346,1.374,1.374,1.361,1.367,1.369,1.384,1.339,1.369,1.375,1.375,1.386,1.38,1.374,1.371,1.371,1.373,1.355,1.353,1.36,1.36,1.373,1.392,1.365,1.35,1.402,1.382,1.347,1.353,1.34,1.321,1.374,1.362,1.376,1.393,1.38,1.375,1.363,1.36,1.358,1.374,1.371,1.361,1.357,1.368,1.361,1.38,1.334,1.364,1.395,1.374,1.36,1.347,1.367,1.389,1.373,1.375,1.392,1.398,1.36,1.371,1.354,1.361,1.423,1.34,1.391,1.391,1.359,1.369,1.357,1.35,1.364,1.359,1.378,1.351,1.356,1.365,1.383,1.349,1.344,1.355,1.388,1.388,1.409,1.378,1.35,1.384,1.369,1.409,1.384,1.391,1.351,1.356,1.351,1.366,1.33,1.388,1.404,1.379,1.36,1.397,1.367,1.364,1.406,1.394,1.382,1.339,1.365,1.391,1.41,1.346,1.38,1.384,1.384,1.373,1.373,1.382,1.359,1.37,1.356,1.403,1.354,1.349,1.39,1.386,1.359,1.431,1.388,1.393,1.37,1.375,1.37,1.39,1.334,1.339,1.38,1.387,1.36,1.343,1.374,1.377,1.359,1.373,1.379,1.359,1.339,1.338,1.395,1.34,1.341,1.366,1.373,1.393,1.353,1.38,1.358,1.385,1.407,1.352,1.372,1.385,1.328,1.38,1.411,1.346,1.393,1.415,1.362,1.377,1.361,1.367,1.363,1.387,1.364,1.358,1.387,1.368,1.364,1.384,1.404,1.416,1.385,1.357,1.372,1.405,1.373,1.368,1.374,1.347,1.387,1.376,1.358,1.372,1.336],"type":"scatter"},{"hovertemplate":"Method: Q-Learning\u003cbr\u003eEpisode: %{x}\u003cbr\u003eLength: %{y}\u003cextra\u003e\u003c\u002fextra\u003e","line":{"color":"#e7e3cb"},"name":"Q-Learning","showlegend":false,"x":[0,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,17000,18000,19000,20000,21000,22000,23000,24000,25000,26000,27000,28000,29000,30000,31000,32000,33000,34000,35000,36000,37000,38000,39000,40000,41000,42000,43000,44000,45000,46000,47000,48000,49000,50000,51000,52000,53000,54000,55000,56000,57000,58000,59000,60000,61000,62000,63000,64000,65000,66000,67000,68000,69000,70000,71000,72000,73000,74000,75000,76000,77000,78000,79000,80000,81000,82000,83000,84000,85000,86000,87000,88000,89000,90000,91000,92000,93000,94000,95000,96000,97000,98000,99000,100000,101000,102000,103000,104000,105000,106000,107000,108000,109000,110000,111000,112000,113000,114000,115000,116000,117000,118000,119000,120000,121000,122000,123000,124000,125000,126000,127000,128000,129000,130000,131000,132000,133000,134000,135000,136000,137000,138000,139000,140000,141000,142000,143000,144000,145000,146000,147000,148000,149000,150000,151000,152000,153000,154000,155000,156000,157000,158000,159000,160000,161000,162000,163000,164000,165000,166000,167000,168000,169000,170000,171000,172000,173000,174000,175000,176000,177000,178000,179000,180000,181000,182000,183000,184000,185000,186000,187000,188000,189000,190000,191000,192000,193000,194000,195000,196000,197000,198000,199000,200000,201000,202000,203000,204000,205000,206000,207000,208000,209000,210000,211000,212000,213000,214000,215000,216000,217000,218000,219000,220000,221000,222000,223000,224000,225000,226000,227000,228000,229000,230000,231000,232000,233000,234000,235000,236000,237000,238000,239000,240000,241000,242000,243000,244000,245000,246000,247000,248000,249000,250000,251000,252000,253000,254000,255000,256000,257000,258000,259000,260000,261000,262000,263000,264000,265000,266000,267000,268000,269000,270000,271000,272000,273000,274000,275000,276000,277000,278000,279000,280000,281000,282000,283000,284000,285000,286000,287000,288000,289000,290000,291000,292000,293000,294000,295000,296000,297000,298000,299000,300000,301000,302000,303000,304000,305000,306000,307000,308000,309000,310000,311000,312000,313000,314000,315000,316000,317000,318000,319000,320000,321000,322000,323000,324000,325000,326000,327000,328000,329000,330000,331000,332000,333000,334000,335000,336000,337000,338000,339000,340000,341000,342000,343000,344000,345000,346000,347000,348000,349000,350000,351000,352000,353000,354000,355000,356000,357000,358000,359000,360000,361000,362000,363000,364000,365000,366000,367000,368000,369000,370000,371000,372000,373000,374000,375000,376000,377000,378000,379000,380000,381000,382000,383000,384000,385000,386000,387000,388000,389000,390000,391000,392000,393000,394000,395000,396000,397000,398000,399000,400000,401000,402000,403000,404000,405000,406000,407000,408000,409000,410000,411000,412000,413000,414000,415000,416000,417000,418000,419000,420000,421000,422000,423000,424000,425000,426000,427000,428000,429000,430000,431000,432000,433000,434000,435000,436000,437000,438000,439000,440000,441000,442000,443000,444000,445000,446000,447000,448000,449000,450000,451000,452000,453000,454000,455000,456000,457000,458000,459000,460000,461000,462000,463000,464000,465000,466000,467000,468000,469000,470000,471000,472000,473000,474000,475000,476000,477000,478000,479000,480000,481000,482000,483000,484000,485000,486000,487000,488000,489000,490000,491000,492000,493000,494000,495000,496000,497000,498000,499000,500000,501000,502000,503000,504000,505000,506000,507000,508000,509000,510000,511000,512000,513000,514000,515000,516000,517000,518000,519000,520000,521000,522000,523000,524000,525000,526000,527000,528000,529000,530000,531000,532000,533000,534000,535000,536000,537000,538000,539000,540000,541000,542000,543000,544000,545000,546000,547000,548000,549000,550000,551000,552000,553000,554000,555000,556000,557000,558000,559000,560000,561000,562000,563000,564000,565000,566000,567000,568000,569000,570000,571000,572000,573000,574000,575000,576000,577000,578000,579000,580000,581000,582000,583000,584000,585000,586000,587000,588000,589000,590000,591000,592000,593000,594000,595000,596000,597000,598000,599000,600000,601000,602000,603000,604000,605000,606000,607000,608000,609000,610000,611000,612000,613000,614000,615000,616000,617000,618000,619000,620000,621000,622000,623000,624000,625000,626000,627000,628000,629000,630000,631000,632000,633000,634000,635000,636000,637000,638000,639000,640000,641000,642000,643000,644000,645000,646000,647000,648000,649000,650000,651000,652000,653000,654000,655000,656000,657000,658000,659000,660000,661000,662000,663000,664000,665000,666000,667000,668000,669000,670000,671000,672000,673000,674000,675000,676000,677000,678000,679000,680000,681000,682000,683000,684000,685000,686000,687000,688000,689000,690000,691000,692000,693000,694000,695000,696000,697000,698000,699000,700000,701000,702000,703000,704000,705000,706000,707000,708000,709000,710000,711000,712000,713000,714000,715000,716000,717000,718000,719000,720000,721000,722000,723000,724000,725000,726000,727000,728000,729000,730000,731000,732000,733000,734000,735000,736000,737000,738000,739000,740000,741000,742000,743000,744000,745000,746000,747000,748000,749000,750000,751000,752000,753000,754000,755000,756000,757000,758000,759000,760000,761000,762000,763000,764000,765000,766000,767000,768000,769000,770000,771000,772000,773000,774000,775000,776000,777000,778000,779000,780000,781000,782000,783000,784000,785000,786000,787000,788000,789000,790000,791000,792000,793000,794000,795000,796000,797000,798000,799000,800000,801000,802000,803000,804000,805000,806000,807000,808000,809000,810000,811000,812000,813000,814000,815000,816000,817000,818000,819000,820000,821000,822000,823000,824000,825000,826000,827000,828000,829000,830000,831000,832000,833000,834000,835000,836000,837000,838000,839000,840000,841000,842000,843000,844000,845000,846000,847000,848000,849000,850000,851000,852000,853000,854000,855000,856000,857000,858000,859000,860000,861000,862000,863000,864000,865000,866000,867000,868000,869000,870000,871000,872000,873000,874000,875000,876000,877000,878000,879000,880000,881000,882000,883000,884000,885000,886000,887000,888000,889000,890000,891000,892000,893000,894000,895000,896000,897000,898000,899000,900000,901000,902000,903000,904000,905000,906000,907000,908000,909000,910000,911000,912000,913000,914000,915000,916000,917000,918000,919000,920000,921000,922000,923000,924000,925000,926000,927000,928000,929000,930000,931000,932000,933000,934000,935000,936000,937000,938000,939000,940000,941000,942000,943000,944000,945000,946000,947000,948000,949000,950000,951000,952000,953000,954000,955000,956000,957000,958000,959000,960000,961000,962000,963000,964000,965000,966000,967000,968000,969000,970000,971000,972000,973000,974000,975000,976000,977000,978000,979000,980000,981000,982000,983000,984000,985000,986000,987000,988000,989000,990000,991000,992000,993000,994000,995000,996000,997000,998000,999000],"y":[null,1.413,1.387,1.377,1.402,1.376,1.366,1.384,1.375,1.383,1.365,1.416,1.364,1.36,1.37,1.387,1.336,1.373,1.368,1.377,1.369,1.371,1.357,1.361,1.403,1.39,1.362,1.394,1.348,1.379,1.39,1.377,1.382,1.37,1.358,1.365,1.392,1.359,1.389,1.346,1.382,1.391,1.344,1.375,1.407,1.37,1.363,1.396,1.353,1.403,1.373,1.382,1.379,1.369,1.341,1.401,1.393,1.376,1.407,1.372,1.373,1.375,1.38,1.388,1.346,1.375,1.368,1.386,1.383,1.375,1.365,1.379,1.379,1.375,1.406,1.358,1.38,1.385,1.371,1.404,1.379,1.384,1.378,1.37,1.358,1.382,1.341,1.382,1.38,1.39,1.344,1.391,1.396,1.366,1.356,1.371,1.382,1.395,1.355,1.382,1.347,1.397,1.409,1.399,1.385,1.411,1.357,1.437,1.405,1.38,1.394,1.391,1.378,1.364,1.404,1.412,1.375,1.382,1.383,1.343,1.379,1.437,1.39,1.4,1.383,1.354,1.422,1.41,1.397,1.4,1.386,1.393,1.371,1.387,1.425,1.398,1.368,1.366,1.371,1.387,1.39,1.377,1.394,1.383,1.418,1.361,1.364,1.396,1.388,1.362,1.369,1.382,1.423,1.415,1.403,1.363,1.38,1.394,1.407,1.401,1.384,1.415,1.398,1.38,1.414,1.396,1.383,1.393,1.401,1.418,1.407,1.421,1.385,1.435,1.378,1.365,1.409,1.384,1.403,1.398,1.383,1.37,1.395,1.42,1.397,1.368,1.442,1.381,1.392,1.451,1.446,1.39,1.37,1.418,1.417,1.395,1.388,1.416,1.415,1.416,1.411,1.347,1.36,1.361,1.397,1.382,1.383,1.378,1.417,1.383,1.388,1.385,1.395,1.403,1.415,1.396,1.405,1.418,1.436,1.344,1.389,1.399,1.381,1.385,1.414,1.403,1.431,1.412,1.399,1.376,1.382,1.404,1.434,1.395,1.381,1.441,1.411,1.404,1.429,1.409,1.418,1.432,1.39,1.406,1.437,1.4,1.392,1.375,1.378,1.406,1.415,1.43,1.382,1.431,1.406,1.421,1.412,1.395,1.382,1.376,1.38,1.397,1.39,1.4,1.418,1.419,1.409,1.386,1.387,1.4,1.415,1.436,1.38,1.4,1.406,1.411,1.398,1.402,1.382,1.405,1.399,1.389,1.377,1.395,1.393,1.407,1.398,1.374,1.389,1.435,1.409,1.406,1.431,1.428,1.431,1.394,1.441,1.399,1.427,1.411,1.386,1.407,1.379,1.407,1.376,1.399,1.41,1.42,1.391,1.413,1.418,1.401,1.42,1.409,1.442,1.399,1.365,1.399,1.393,1.385,1.446,1.419,1.428,1.402,1.367,1.377,1.39,1.417,1.459,1.386,1.394,1.405,1.41,1.412,1.415,1.44,1.415,1.458,1.415,1.413,1.405,1.385,1.386,1.404,1.405,1.433,1.43,1.41,1.374,1.405,1.4,1.428,1.424,1.431,1.439,1.398,1.417,1.428,1.424,1.44,1.39,1.426,1.408,1.405,1.405,1.419,1.434,1.381,1.405,1.426,1.435,1.395,1.425,1.394,1.407,1.393,1.444,1.414,1.41,1.422,1.416,1.431,1.431,1.418,1.434,1.425,1.42,1.447,1.396,1.407,1.449,1.437,1.436,1.43,1.421,1.389,1.444,1.405,1.442,1.433,1.433,1.426,1.404,1.445,1.428,1.418,1.405,1.404,1.437,1.44,1.434,1.399,1.444,1.44,1.405,1.39,1.436,1.423,1.376,1.448,1.439,1.414,1.452,1.435,1.433,1.41,1.444,1.436,1.415,1.405,1.424,1.428,1.403,1.415,1.411,1.458,1.41,1.412,1.426,1.392,1.445,1.42,1.428,1.443,1.436,1.422,1.413,1.426,1.413,1.386,1.455,1.46,1.454,1.411,1.439,1.406,1.429,1.403,1.472,1.447,1.404,1.386,1.437,1.407,1.395,1.446,1.429,1.427,1.386,1.417,1.459,1.444,1.414,1.432,1.484,1.454,1.429,1.447,1.431,1.478,1.454,1.449,1.431,1.415,1.382,1.463,1.436,1.456,1.426,1.44,1.43,1.423,1.445,1.453,1.434,1.403,1.449,1.428,1.465,1.422,1.418,1.458,1.46,1.46,1.43,1.449,1.419,1.439,1.424,1.42,1.431,1.43,1.42,1.442,1.429,1.411,1.444,1.413,1.415,1.447,1.455,1.457,1.407,1.436,1.463,1.452,1.457,1.438,1.414,1.447,1.408,1.428,1.446,1.408,1.414,1.431,1.408,1.432,1.457,1.427,1.414,1.448,1.429,1.416,1.424,1.482,1.422,1.413,1.443,1.428,1.484,1.416,1.471,1.473,1.455,1.44,1.435,1.437,1.427,1.429,1.436,1.43,1.443,1.434,1.468,1.432,1.448,1.466,1.407,1.434,1.452,1.46,1.471,1.483,1.464,1.475,1.423,1.44,1.439,1.44,1.44,1.423,1.468,1.458,1.427,1.451,1.429,1.459,1.468,1.48,1.423,1.42,1.472,1.433,1.471,1.438,1.451,1.445,1.445,1.463,1.428,1.46,1.457,1.44,1.435,1.493,1.443,1.472,1.447,1.508,1.456,1.503,1.451,1.455,1.479,1.462,1.47,1.438,1.418,1.464,1.442,1.462,1.452,1.474,1.447,1.478,1.452,1.398,1.496,1.445,1.44,1.466,1.437,1.491,1.472,1.507,1.46,1.487,1.459,1.473,1.485,1.506,1.516,1.496,1.488,1.474,1.489,1.471,1.48,1.424,1.452,1.486,1.466,1.447,1.507,1.448,1.462,1.484,1.503,1.438,1.515,1.46,1.467,1.467,1.462,1.454,1.453,1.477,1.48,1.466,1.498,1.451,1.469,1.478,1.436,1.512,1.488,1.469,1.465,1.442,1.469,1.442,1.497,1.437,1.464,1.443,1.457,1.504,1.447,1.493,1.466,1.456,1.432,1.506,1.443,1.449,1.502,1.473,1.469,1.452,1.448,1.516,1.487,1.456,1.463,1.489,1.472,1.496,1.482,1.483,1.493,1.454,1.497,1.483,1.468,1.457,1.493,1.462,1.468,1.456,1.467,1.478,1.466,1.483,1.483,1.483,1.5,1.495,1.484,1.474,1.458,1.526,1.473,1.455,1.487,1.495,1.517,1.462,1.448,1.47,1.461,1.471,1.457,1.485,1.448,1.503,1.489,1.453,1.48,1.483,1.463,1.487,1.466,1.485,1.479,1.476,1.471,1.468,1.492,1.467,1.519,1.477,1.505,1.48,1.507,1.502,1.505,1.497,1.452,1.484,1.499,1.482,1.51,1.497,1.492,1.473,1.491,1.494,1.445,1.5,1.496,1.503,1.542,1.489,1.494,1.528,1.407,1.48,1.443,1.468,1.467,1.449,1.5,1.522,1.491,1.484,1.48,1.52,1.47,1.496,1.514,1.487,1.461,1.508,1.507,1.506,1.514,1.466,1.505,1.502,1.433,1.494,1.46,1.454,1.486,1.508,1.489,1.478,1.498,1.488,1.485,1.497,1.452,1.515,1.481,1.476,1.491,1.515,1.497,1.491,1.474,1.492,1.456,1.509,1.522,1.499,1.479,1.505,1.458,1.529,1.489,1.489,1.506,1.511,1.444,1.467,1.494,1.499,1.509,1.491,1.512,1.476,1.527,1.446,1.494,1.517,1.487,1.502,1.483,1.49,1.508,1.488,1.482,1.5,1.494,1.505,1.506,1.484,1.519,1.526,1.48,1.519,1.504,1.533,1.485,1.533,1.459,1.488,1.513,1.519,1.465,1.553,1.503,1.491,1.481,1.499,1.517,1.546,1.477,1.465,1.527,1.496,1.492,1.514,1.525,1.451,1.498,1.528,1.5,1.512,1.513,1.456,1.494,1.454,1.509,1.5,1.509,1.522,1.515,1.51,1.555,1.465,1.544,1.47,1.533,1.51,1.525,1.486,1.521,1.5,1.536,1.541,1.491,1.524,1.516,1.5,1.498,1.482,1.496,1.522,1.52,1.473,1.478,1.537,1.517,1.5,1.535,1.5,1.526,1.53,1.517,1.493,1.52,1.508,1.48,1.52,1.523,1.522,1.518,1.477,1.514,1.522,1.522,1.513,1.519,1.498,1.53,1.504,1.509,1.519,1.531,1.546,1.509,1.498,1.494,1.538,1.54,1.496,1.541,1.523,1.493,1.522,1.562,1.552,1.511,1.521,1.536,1.523,1.545,1.52,1.518,1.56,1.522,1.576,1.55,1.545,1.482,1.491,1.495,1.509,1.502,1.501,1.54,1.506,1.506,1.509,1.559,1.543,1.551,1.51],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Episode lengths","font":{"size":16},"x":0},"yaxis":{"range":[1.3,1.6],"showline":false,"gridwidth":2,"gridcolor":"#fafafa","zerolinecolor":"#fafafa"},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"legend":{"orientation":"h","itemsizing":"constant","x":0.05,"y":0.9,"yanchor":"middle"},"paper_bgcolor":"transparent","plot_bgcolor":"transparent","xaxis":{"showline":true,"linewidth":2,"linecolor":"black"}},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

Let's play out 1,000,000 games for each policy and compare the mean rewards. As an additional datapoint, we'll also include a policy based on the simple strategy of hitting until our sum is 18 or more, which we saw in the Gymnasium Environment section.


```python
# Simple strategy: hit until our sum is 18 or more
simple_policy = np.zeros((32, 11, 2), dtype=int)
simple_policy[:19,:,:] = 1
```


```python
env = gym.make("Blackjack-v1")

policies = [
    simple_policy,
    np.argmax(Q1, axis=-1),
    np.argmax(Q2, axis=-1),
    np.argmax(Q3, axis=-1),
]
rewards = [[], [], [], []]

for _ in range(1_000_000):
    for i, policy in enumerate(policies):
        state, info = env.reset()

        while True:
            player_sum, dealer_card, usable_ace = state
            action = policy[player_sum, dealer_card, usable_ace]
            state, reward, terminated, truncated, info = env.step(action)
            if terminated or truncated:
                rewards[i].append(reward)
                break

print(np.mean(rewards[0]))
print(np.mean(rewards[1]))
print(np.mean(rewards[2]))
print(np.mean(rewards[3]))
```

    -0.19649
    -0.045929
    -0.043312
    -0.042268


As we see here, these are all losing strategies, although the derived policies perform markedly better than the simple strategy. In fact, this falls in line with commonly accepted house edge figures of 2% with simple strategies and 0.5% when employing Basic Strategy.

## Extending the Environment

In this section, we'll attempt to extend the simplified Blackjack version to include the double and split actions that make up the full game.

The simple Blackjack environment uses an observation space that comprises of 3 numbers:
- the player's current sum (1-31, the top of the range is when a player decides to hit a 21)
- the value of the dealer's one showing card (1-10, where 1 is ace)
- whether the player holds a usable ace (0 or 1)

To support the full game, we change the observation space to include 6 numbers:
- the value of the player's first card (1-10)
- the value of the player's second card (1-10)
- *the player’s current sum (1-31, the top of the range is when a player decides to hit a 21)*
- *the value of the dealer’s one showing card (1-10, where 1 is ace)*
- *whether the player holds a usable ace (0 or 1)*
- the number of splits taken place (0-2)

Not only is this new observation space much bigger, it also contains illegal states (e.g. the player sum may not add up to first card and second hand), which can be problematic.

### Dynamic Programming: Policy Iteration


```python
def expected_return(state, action, V, gamma=1.0):
    first_card, second_card, player_sum, dealer_card_value, usable_ace, splits = state
    rewards = 0.0

    # 1 = Ace, 2-10 = Number cards, Jack/Queen/King = 10
    deck = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]

    # Get probabilities for each card in the deck
    card_probabilities = {card: deck.count(card) / len(deck) for card in set(deck)}

    if action in [3, 4]:  # double
        can_double = (
            sum_hand([first_card, second_card]) == player_sum
            and first_card > 0
            and second_card > 0
            and (
                ((usable_ace == 0) and (first_card != 1 and second_card != 1))
                or ((usable_ace == 1) and (first_card == 1 or second_card == 1))
            )
        )
        if can_double:
            for next_card in set(deck):
                player_cards = [first_card, second_card, next_card]
                next_player_sum = sum_hand(player_cards)

                if is_bust(player_cards):
                    reward = -2.0
                else:
                    dealer_scores = probabilities[dealer_card_value]
                    wins = np.sum(dealer_scores[0:next_player_sum])
                    losses = np.sum(dealer_scores[(next_player_sum + 1) :])
                    reward = wins - losses

                rewards += 2.0 * card_probabilities[next_card] * reward
        else:
            if action == 3:  # convert to stand
                action = 0
            elif action == 4:  # convert to hit
                action = 1

    if action == 0:  # stand
        dealer_scores = probabilities[dealer_card_value]
        wins = np.sum(dealer_scores[0:player_sum])
        losses = np.sum(dealer_scores[(player_sum + 1) :])
        rewards = wins - losses
    elif action == 1:  # hit
        for next_card in set(deck):
            if first_card == 0:
                player_cards = [next_card]
                next_first_card = next_card
                next_second_card = 0
            elif second_card == 0:
                player_cards = [first_card, next_card]
                next_first_card = first_card
                next_second_card = next_card
            else:
                player_cards = [1, player_sum - 11] if usable_ace else [player_sum]
                player_cards.append(next_card)
                next_first_card = first_card
                next_second_card = second_card

            next_player_sum = sum_hand(player_cards)
            next_usable_ace = has_usable_ace(player_cards)

            if is_bust(player_cards):
                reward = -1.0
            else:
                next_state = (
                    next_first_card,
                    next_second_card,
                    next_player_sum,
                    dealer_card_value,
                    next_usable_ace,
                    splits,
                )
                reward = gamma * V[next_state]  # no immediate reward for hitting

            rewards += card_probabilities[next_card] * reward
    elif action == 2:  # split
        can_split = (
            sum_hand([first_card, second_card]) == player_sum
            and first_card > 0
            and second_card > 0
            and (
                ((usable_ace == 0) and (first_card != 1 and second_card != 1))
                or ((usable_ace == 1) and (first_card == 1 or second_card == 1))
            )
            and first_card == second_card
            and splits < 2
        )
        if can_split:
            for next_card in set(deck):
                player_cards = [first_card, next_card]
                next_state = (
                    first_card,
                    next_card,
                    sum_hand(player_cards),
                    dealer_card_value,
                    has_usable_ace(player_cards),
                    splits + 1,
                )
                reward = gamma * V[next_state]
                rewards += 2.0 * card_probabilities[next_card] * reward
        else:
            rewards = -2.0  # illegal action

    return rewards


def policy_evaluation(V, policy, theta=1e-10):
    while True:
        delta = 0.0
        for state in np.ndindex(V.shape):
            v = V[state]
            action = policy[state]
            V[state] = expected_return(state, action, V)
            delta = max(delta, abs(v - V[state]))
        if delta < theta:
            break


def policy_improvement(V, policy):
    policy_stable = True
    for state in np.ndindex(V.shape):
        old_action = policy[state]
        action_values = {
            action: expected_return(state, action, V) for action in range(5)
        }
        policy[state] = max(action_values, key=action_values.get)
        if old_action != policy[state]:
            policy_stable = False

    return policy_stable


def policy_iteration(V, policy):
    policy_stable = False
    while not policy_stable:
        policy_evaluation(V, policy)
        policy_stable = policy_improvement(V, policy)

    return V, policy
```


```python
# Initialize state-value function V and policy
V = np.zeros((11, 11, 22, 11, 2, 3))
policy = np.zeros((11, 11, 22, 11, 2, 3), dtype=int)

policy_iteration(V, policy)

# Build state-action-value function Q
Q4 = np.zeros((11, 11, 22, 11, 2, 3, 5))

for index in np.ndindex(Q4.shape):
    *state, action = index
    Q4[index] = expected_return(state, action, V)
```

#### Optimal Policy using Policy Iteration

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-4"><div>                            <div id="93598370-3652-4126-a605-81e2d3bdfd62" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("93598370-3652-4126-a605-81e2d3bdfd62")) {                    Plotly.newPlot(                        "93598370-3652-4126-a605-81e2d3bdfd62",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,4,1,1,1,1],[0,1,1,1,1,4,4,1,1,1,1],[0,1,1,1,1,4,4,1,1,1,1],[0,1,1,1,4,4,4,1,1,1,1],[0,1,1,4,4,4,4,1,1,1,1],[0,1,0,3,3,3,3,0,0,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eSoft player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Double else hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Double else hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Double else hit","Double else hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Double else hit","Double else hit","Double else hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Double else stand","Double else stand","Double else stand","Double else stand","Stand","Stand","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[12.5,21.5],"tickmode":"linear","showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Soft player sum vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-4"><div>                            <div id="74b77a33-dc60-44f8-ba6d-a4f85e3cc864" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("74b77a33-dc60-44f8-ba6d-a4f85e3cc864")) {                    Plotly.newPlot(                        "74b77a33-dc60-44f8-ba6d-a4f85e3cc864",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1,1],[0,1,1,4,4,4,4,1,1,1,1],[0,1,4,4,4,4,4,4,4,4,1],[0,1,4,4,4,4,4,4,4,4,1],[0,1,1,1,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,1,0,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eHard player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Double else hit","Double else hit","Double else hit","Double else hit","Hit","Hit","Hit","Hit"],["Stand","Hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Hit"],["Stand","Hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Hit"],["Stand","Hit","Hit","Hit","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Stand","Stand","Stand","Stand","Stand","Hit","Hit","Hit","Hit"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[4.5,21.5],"tickmode":"linear","showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Hard player sum vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-4"><div>                            <div id="90529caa-02a8-4e18-a147-dd358a320092" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("90529caa-02a8-4e18-a147-dd358a320092")) {                    Plotly.newPlot(                        "90529caa-02a8-4e18-a147-dd358a320092",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,2,2,2,2,2,0,2,2,0],[0,1,2,2,2,2,2,2,2,2,1],[0,1,2,2,2,2,2,2,1,1,1],[0,1,2,2,2,2,2,1,1,1,1],[0,1,3,3,3,3,3,3,3,3,1],[0,1,1,1,1,2,2,1,1,1,1],[0,1,2,2,2,2,2,2,1,1,1],[0,1,2,2,2,2,2,2,1,1,1],[0,2,2,2,2,2,2,2,2,2,2]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003ePlayer pair: %{y},%{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Split","Split","Split","Split","Split","Stand","Split","Split","Stand"],["Stand","Hit","Split","Split","Split","Split","Split","Split","Split","Split","Hit"],["Stand","Hit","Split","Split","Split","Split","Split","Split","Hit","Hit","Hit"],["Stand","Hit","Split","Split","Split","Split","Split","Hit","Hit","Hit","Hit"],["Stand","Hit","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Hit"],["Stand","Hit","Hit","Hit","Hit","Split","Split","Hit","Hit","Hit","Hit"],["Stand","Hit","Split","Split","Split","Split","Split","Split","Hit","Hit","Hit"],["Stand","Hit","Split","Split","Split","Split","Split","Split","Hit","Hit","Hit"],["Stand","Split","Split","Split","Split","Split","Split","Split","Split","Split","Split"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":"reversed","range":[0.5,10.5],"tickvals":[0,1,2,3,4,5,6,7,8,9],"ticktext":["10","9","8","7","6","5","4","3","2","A"],"showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Player pair vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

The basic strategy for the full Blackjack game derived from policy iteration largely corresponds with the Wizard of Odds' Basic Strategy Table[^shackleford10].

### Monte Carlo: Monte Carlo with Exploring Starts

We try to recreate the full Blackjack game as a custom Gymnasium environment so we can apply Monte Carlo with Exploring Starts.


```python
from gymnasium import spaces


# 1 = Ace, 2-10 = Number cards, Jack/Queen/King = 10
deck = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10]


class BlackjackEnv(gym.Env):
    """
    Added double and split actions to Blackjack environment from:
    https://github.com/Farama-Foundation/Gymnasium/blob/main/gymnasium/envs/toy_text/blackjack.py
    """

    def __init__(self, hit_soft_17=False, double_after_split=True):
        self.action_space = spaces.Discrete(5)
        self.observation_space = spaces.Tuple(
            (
                spaces.Discrete(11),
                spaces.Discrete(11),
                spaces.Discrete(32),
                spaces.Discrete(11),
                spaces.Discrete(2),
                spaces.Discrete(3),
            )
        )
        self.hit_soft_17 = hit_soft_17
        self.double_after_split = double_after_split

    def step(self, action):
        assert self.action_space.contains(action)

        if action in [3, 4]:  # double
            can_double = len(self.player) == 2 and (
                self.splits == 0 or self.double_after_split
            )
            if can_double:
                self.player.append(draw_card(self.np_random))
                terminated = True
                if is_bust(self.player):
                    reward = -2.0
                else:
                    reward = 2.0 * self.play_dealer()
            else:
                if action == 3:  # convert to stand
                    action = 0
                elif action == 4:  # convert to hit
                    action = 1

        if action == 0:  # stand
            terminated = True
            reward = self.play_dealer()
        elif action == 1:  # hit
            self.player.append(draw_card(self.np_random))
            if is_bust(self.player):
                terminated = True
                reward = -1.0
            else:
                terminated = False
                reward = 0.0
        elif action == 2:  # split
            can_split = (
                self.splits < 2
                and len(self.player) == 2
                and self.player[0] == self.player[1]
            )
            if can_split:
                # Assume split hands play out the same and only follow one of the splits
                # Cannot bust on 2 cards so no need to check
                self.splits += 1
                self.player[1] = draw_card(self.np_random)
                terminated = False
                reward = 0.0
            else:
                terminated = True
                reward = -1.0

        return self._get_obs(), reward *(2**self.splits), terminated, False, {}

    def play_dealer(self):
        soft_17 = has_usable_ace(self.dealer) and sum_hand(self.dealer) == 17
        while sum_hand(self.dealer) < 17 or (soft_17 and self.hit_soft_17):
            self.dealer.append(draw_card(self.np_random))

        return cmp(score(self.player), score(self.dealer))

    def _get_obs(self):
        return (
            self.player[0],
            self.player[1],
            sum_hand(self.player),
            self.dealer[0],
            has_usable_ace(self.player),
            self.splits,
        )

    def reset(self, seed=None, options=None):
        super().reset(seed=seed)
        self.splits = 0
        self.dealer = draw_hand(self.np_random)
        self.player = draw_hand(self.np_random)
        return self._get_obs(), {}
```


```python
env = BlackjackEnv()
Qs5, return_queue5, length_queue5 = monte_carlo_es(env, num_episodes=20_000_000, deque_size=100)
Q5 = Qs5[-1]
```

#### Optimal Policy using Monte Carlo ES (20M Episodes)

<div class="container mb-3 px-0">
    <div class="row">
        <div class="col-12 col-md-4"><div>                            <div id="15fe20bd-6bcc-4195-a321-2213996964a2" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("15fe20bd-6bcc-4195-a321-2213996964a2")) {                    Plotly.newPlot(                        "15fe20bd-6bcc-4195-a321-2213996964a2",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,2,2,2,2,2,2,2,2,2,2],[0,1,0,4,3,4,1,1,1,1,1],[0,0,3,4,4,4,4,4,1,4,0],[0,1,3,0,4,4,0,1,1,4,1],[0,4,1,4,1,3,0,4,4,4,1],[0,1,0,3,0,3,0,3,0,0,1],[0,0,0,0,3,3,3,3,0,4,0],[0,0,3,3,3,3,3,3,0,0,3],[0,0,0,0,0,3,3,0,0,0,0],[0,0,0,0,3,0,3,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eSoft player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Split","Split","Split","Split","Split","Split","Split","Split","Split","Split"],["Stand","Hit","Stand","Double else hit","Double else stand","Double else hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Stand","Double else stand","Double else hit","Double else hit","Double else hit","Double else hit","Double else hit","Hit","Double else hit","Stand"],["Stand","Hit","Double else stand","Stand","Double else hit","Double else hit","Stand","Hit","Hit","Double else hit","Hit"],["Stand","Double else hit","Hit","Double else hit","Hit","Double else stand","Stand","Double else hit","Double else hit","Double else hit","Hit"],["Stand","Hit","Stand","Double else stand","Stand","Double else stand","Stand","Double else stand","Stand","Stand","Hit"],["Stand","Stand","Stand","Stand","Double else stand","Double else stand","Double else stand","Double else stand","Stand","Double else hit","Stand"],["Stand","Stand","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Double else stand","Stand","Stand","Double else stand"],["Stand","Stand","Stand","Stand","Stand","Double else stand","Double else stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Double else stand","Stand","Double else stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[12.5,21.5],"tickmode":"linear","showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Soft player sum vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-4"><div>                            <div id="e886dc12-b5e5-44ca-955f-7adb601256a0" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e886dc12-b5e5-44ca-955f-7adb601256a0")) {                    Plotly.newPlot(                        "e886dc12-b5e5-44ca-955f-7adb601256a0",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,1,1,2,1,2,1,1,1,1],[0,1,1,1,0,1,1,1,1,1,1],[0,0,1,1,1,1,3,1,1,1,1],[0,1,4,4,0,0,0,1,1,1,0],[0,1,3,1,4,3,3,4,1,4,1],[0,1,4,3,4,3,1,4,1,4,1],[0,1,3,3,3,1,3,4,1,1,4],[0,1,1,4,4,4,1,1,4,4,4],[0,0,0,0,0,3,0,4,0,1,0],[0,1,0,0,0,0,3,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,3,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,3,3,0,0,3,0,0,0,3],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003eHard player sum: %{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Hit","Hit","Split","Hit","Split","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Stand","Hit","Hit","Hit","Hit","Hit","Hit"],["Stand","Stand","Hit","Hit","Hit","Hit","Double else stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Double else hit","Double else hit","Stand","Stand","Stand","Hit","Hit","Hit","Stand"],["Stand","Hit","Double else stand","Hit","Double else hit","Double else stand","Double else stand","Double else hit","Hit","Double else hit","Hit"],["Stand","Hit","Double else hit","Double else stand","Double else hit","Double else stand","Hit","Double else hit","Hit","Double else hit","Hit"],["Stand","Hit","Double else stand","Double else stand","Double else stand","Hit","Double else stand","Double else hit","Hit","Hit","Double else hit"],["Stand","Hit","Hit","Double else hit","Double else hit","Double else hit","Hit","Hit","Double else hit","Double else hit","Double else hit"],["Stand","Stand","Stand","Stand","Stand","Double else stand","Stand","Double else hit","Stand","Hit","Stand"],["Stand","Hit","Stand","Stand","Stand","Stand","Double else stand","Stand","Hit","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Double else stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Double else stand","Double else stand","Stand","Stand","Double else stand","Stand","Stand","Stand","Double else stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":false,"range":[4.5,21.5],"tickmode":"linear","showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Hard player sum vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
        <div class="col-12 col-md-4"><div>                            <div id="3e55799c-6577-4ab9-a1c8-35b6a29c4022" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("3e55799c-6577-4ab9-a1c8-35b6a29c4022")) {                    Plotly.newPlot(                        "3e55799c-6577-4ab9-a1c8-35b6a29c4022",                        [{"coloraxis":"coloraxis","name":"0","z":[[0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0],[0,1,2,2,2,2,2,2,2,1,1],[0,1,0,0,2,2,2,2,1,1,1],[0,1,1,0,2,2,2,1,1,1,1],[0,1,3,4,3,3,3,4,4,4,1],[0,1,1,1,3,3,3,1,1,1,1],[0,1,1,1,1,1,2,1,1,1,1],[0,1,1,1,2,1,2,1,1,1,1],[0,2,2,2,2,2,2,2,2,2,2]],"type":"heatmap","xaxis":"x","yaxis":"y","hovertemplate":"Dealer showing: %{x}\u003cbr\u003ePlayer pair: %{y},%{y}\u003cbr\u003eAction: %{customdata}\u003cextra\u003e\u003c\u002fextra\u003e","customdata":[["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand","Stand"],["Stand","Hit","Split","Split","Split","Split","Split","Split","Split","Hit","Hit"],["Stand","Hit","Stand","Stand","Split","Split","Split","Split","Hit","Hit","Hit"],["Stand","Hit","Hit","Stand","Split","Split","Split","Hit","Hit","Hit","Hit"],["Stand","Hit","Double else stand","Double else hit","Double else stand","Double else stand","Double else stand","Double else hit","Double else hit","Double else hit","Hit"],["Stand","Hit","Hit","Hit","Double else stand","Double else stand","Double else stand","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Hit","Hit","Split","Hit","Hit","Hit","Hit"],["Stand","Hit","Hit","Hit","Split","Hit","Split","Hit","Hit","Hit","Hit"],["Stand","Split","Split","Split","Split","Split","Split","Split","Split","Split","Split"]]}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"showgrid":false,"range":[0.5,10.5],"tickvals":[1,2,3,4,5,6,7,8,9,10],"ticktext":["A","2","3","4","5","6","7","8","9","10"]},"yaxis":{"anchor":"x","domain":[0.0,1.0],"autorange":"reversed","range":[0.5,10.5],"tickvals":[0,1,2,3,4,5,6,7,8,9],"ticktext":["10","9","8","7","6","5","4","3","2","A"],"showgrid":false},"coloraxis":{"colorscale":[[0.0,"#fafafa"],[0.125,"#fafafa"],[0.125,"#d7d6cc"],[0.375,"#d7d6cc"],[0.375,"#e7e3cb"],[0.625,"#e7e3cb"],[0.625,"#dee2e6"],[0.875,"#dee2e6"],[0.875,"#adb5bd"],[1.0,"#adb5bd"]],"cmin":0,"cmax":4,"showscale":false},"title":{"text":"Player pair vs. dealer showing","font":{"size":16},"x":0},"margin":{"l":0,"r":0,"t":50,"b":0},"font":{"family":"Hanken Grotesk","size":16},"paper_bgcolor":"transparent","plot_bgcolor":"#fafafa"},                        {"displayModeBar": false, "responsive": true}                    )                };                            </script>        </div></div>
    </div>
</div>

Due to the observation space being so large, even after running Monte Carlo with Exploring Starts for 20,000,000 episodes, we are still far from convergence.

## References

[^baldwin56]: [Baldwin, R. R., Cantey, W. E., Maisel, H., & McDermott, J. P. (1956). The Optimum Strategy in Blackjack. Journal of the American Statistical Association.](https://web.williams.edu/Mathematics/sjmiller/public_html/341Fa09/handouts/Baldwin_OptimalStrategyBlackjack.pdf)

[^qfit23]: [QFIT. (2023). Casino Vérité Blackjack Simulator. Computer software.](https://www.qfit.com/blackjack-simulator.htm)

[^shackleford10]: [Shackleford, M. (2010). Blackjack Basic Strategy Calculator. Wizard of Odds.](https://wizardofodds.com/games/blackjack/strategy/calculator/)

[^silver15]: [Silver, D. (2015). Reinforcement Learning Assignment: Easy21. Lectures on Reinforcement Learning.](https://www.davidsilver.uk/wp-content/uploads/2020/03/Easy21-Johannes.pdf)

[^sutton20]: [Sutton, R. S. & Barto, A. G. (2020) Reinforcement Learning: An Introduction. Second edition. MIT Press.](http://incompleteideas.net/book/the-book-2nd.html)

[^thorp66]: [Thorp, E. (1966). Beat the Dealer: A Winning Strategy for the Game of Twenty-One.](http://www.edwardothorp.com/books/beat-the-dealer/)

[^towers23]: [Towers, M., Terry, J. K., Kwiatkowski, A., Balis, J. U., de Cola, G., Deleu, T., Goulão, M., Kallinteris, A., KG, A., Krimmel, M., Perez-Vicente, R., Pierré, A., Schulhoff, S., Tai, J. J., Tan, A. J. S., & Younis, O. G. (2023). Gymnasium. Computer software.](https://github.com/Farama-Foundation/Gymnasium)

[^zemann22]: [Zemann, T. (2022). Solving Blackjack with Q-Learning. Gymnasium documentation.](https://gymnasium.farama.org/tutorials/training_agents/blackjack_tutorial/)
